<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>【非公式】実証ビジネス・エコノミクス Juliaでの実装 - 4&nbsp; 需要モデルの推定（応用編）</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./entry_exit_basic.html" rel="next">
<link href="./demand_estimation_2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">需要モデルの推定（応用編）</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">【非公式】実証ビジネス・エコノミクス Juliaでの実装</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">【非公式】実証ビジネス・エコノミクス Juliaでの実装</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./demand_estimation_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">需要モデルの推定（基礎編 1）</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./demand_estimation_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">需要モデルの推定（基礎編 2）</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./demand_estimation_merger.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">需要モデルの推定（応用編）</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./entry_exit_basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">参入ゲームの推定（基礎編）</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./entry_exit_application.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">参入ゲームの推定（応用編）</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./single_agent_dynamic_basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">シングルエージェント動学モデルの推定（基礎編）</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link active" data-scroll-target="#data-cleaning"><span class="toc-section-number">4.1</span>  Data cleaning</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="toc-section-number">4.2</span>  4.2</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="toc-section-number">4.3</span>  4.3</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="toc-section-number">4.4</span>  5</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"><span class="toc-section-number">4.5</span>  6</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"><span class="toc-section-number">4.6</span>  6.4</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"><span class="toc-section-number">4.7</span>  6.5</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"><span class="toc-section-number">4.8</span>  7</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"><span class="toc-section-number">4.9</span>  7.1</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"><span class="toc-section-number">4.10</span>  7.2</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"><span class="toc-section-number">4.11</span>  7.4</a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10"><span class="toc-section-number">4.12</span>  8</a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11"><span class="toc-section-number">4.13</span>  8.2</a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12"><span class="toc-section-number">4.14</span>  8.3</a></li>
  <li><a href="#section-13" id="toc-section-13" class="nav-link" data-scroll-target="#section-13"><span class="toc-section-number">4.15</span>  8.5</a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14"><span class="toc-section-number">4.16</span>  8.6</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">需要モデルの推定（応用編）</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CSV</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StringEncodings</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">FixedEffectModels</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RegressionTables</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optim</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Printf</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ForwardDiff</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">GLM</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Serialization</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> CSV.<span class="fu">read</span>(<span class="st">"data/demand_estimation_merger/chap3_data.csv"</span>, DataFrame);</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(data, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div><div style="float: left;"><span>5×61 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">NameID</th><th style="text-align: left;">year</th><th style="text-align: left;">Maker</th><th style="text-align: left;">Type</th><th style="text-align: left;">Name</th><th style="text-align: left;">Sales</th><th style="text-align: left;">Model</th><th style="text-align: left;">price</th><th style="text-align: left;">kata</th><th style="text-align: left;">FuelEfficiency</th><th style="text-align: left;">capacity</th><th style="text-align: left;">FuelType</th><th style="text-align: left;">HH</th><th style="text-align: left;">size</th><th style="text-align: left;">hppw</th><th style="text-align: left;">share</th><th style="text-align: left;">share0</th><th style="text-align: left;">hppw_sum_own</th><th style="text-align: left;">FuelEfficiency_sum_own</th><th style="text-align: left;">size_sum_own</th><th style="text-align: left;">hppw_sqr_sum_own</th><th style="text-align: left;">FuelEfficiency_sqr_sum_own</th><th style="text-align: left;">size_sqr_sum_own</th><th style="text-align: left;">hppw_sum_mkt</th><th style="text-align: left;">FuelEfficiency_sum_mkt</th><th style="text-align: left;">size_sum_mkt</th><th style="text-align: left;">hppw_sqr_sum_mkt</th><th style="text-align: left;">FuelEfficiency_sqr_sum_mkt</th><th style="text-align: left;">size_sqr_sum_mkt</th><th style="text-align: left;">iv_BLP_own_hppw</th><th style="text-align: left;">iv_BLP_own_FuelEfficiency</th><th style="text-align: left;">iv_BLP_own_size</th><th style="text-align: left;">iv_BLP_other_hppw</th><th style="text-align: left;">iv_BLP_other_FuelEfficiency</th><th style="text-align: left;">iv_BLP_other_size</th><th style="text-align: left;">iv_BLP_own_num</th><th style="text-align: left;">iv_BLP_other_num</th><th style="text-align: left;">iv_GH_own_hppw</th><th style="text-align: left;">iv_GH_own_FuelEfficiency</th><th style="text-align: left;">iv_GH_own_size</th><th style="text-align: left;">iv_GH_other_hppw</th><th style="text-align: left;">iv_GH_other_FuelEfficiency</th><th style="text-align: left;">iv_GH_other_size</th><th style="text-align: left;">logit_share</th><th style="text-align: left;">iv_BLP_own_hppw_nest</th><th style="text-align: left;">iv_BLP_own_FuelEfficiency_nest</th><th style="text-align: left;">iv_BLP_own_size_nest</th><th style="text-align: left;">iv_BLP_other_hppw_nest</th><th style="text-align: left;">iv_BLP_other_FuelEfficiency_nest</th><th style="text-align: left;">iv_BLP_other_size_nest</th><th style="text-align: left;">iv_BLP_own_num_nest</th><th style="text-align: left;">iv_BLP_other_num_nest</th><th style="text-align: left;">iv_GH_own_hppw_nest</th><th style="text-align: left;">iv_GH_own_FuelEfficiency_nest</th><th style="text-align: left;">iv_GH_own_size_nest</th><th style="text-align: left;">iv_GH_other_hppw_nest</th><th style="text-align: left;">iv_GH_other_FuelEfficiency_nest</th><th style="text-align: left;">iv_GH_other_size_nest</th><th style="text-align: left;">sum_year_body</th><th style="text-align: left;">inside_share</th><th style="text-align: left;">log_inside_share</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="String15" style="text-align: left;">String15</th><th title="String7" style="text-align: left;">String7</th><th title="String31" style="text-align: left;">String31</th><th title="Int64" style="text-align: left;">Int64</th><th title="String" style="text-align: left;">String</th><th title="Float64" style="text-align: left;">Float64</th><th title="String15" style="text-align: left;">String15</th><th title="Float64" style="text-align: left;">Float64</th><th title="Int64" style="text-align: left;">Int64</th><th title="String15" style="text-align: left;">String15</th><th title="Int64" style="text-align: left;">Int64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: right;">14</td><td style="text-align: right;">2011</td><td style="text-align: left;">Audi</td><td style="text-align: left;">Foreign</td><td style="text-align: left;">A1シリーズ</td><td style="text-align: right;">4206</td><td style="text-align: left;">1.4 TFSI</td><td style="text-align: right;">2.99804</td><td style="text-align: left;">DBA-8XCAX</td><td style="text-align: right;">19.4</td><td style="text-align: right;">4</td><td style="text-align: left;">ハイオク</td><td style="text-align: right;">53783435</td><td style="text-align: right;">9.94723</td><td style="text-align: right;">0.102521</td><td style="text-align: right;">7.82025e-5</td><td style="text-align: right;">0.938981</td><td style="text-align: right;">0.299061</td><td style="text-align: right;">49.4</td><td style="text-align: right;">33.1397</td><td style="text-align: right;">0.0299428</td><td style="text-align: right;">831.48</td><td style="text-align: right;">369.074</td><td style="text-align: right;">1.93875</td><td style="text-align: right;">276.2</td><td style="text-align: right;">218.564</td><td style="text-align: right;">0.207044</td><td style="text-align: right;">4206.04</td><td style="text-align: right;">2550.97</td><td style="text-align: right;">0.19654</td><td style="text-align: right;">30.0</td><td style="text-align: right;">23.1925</td><td style="text-align: right;">15.7229</td><td style="text-align: right;">2464.5</td><td style="text-align: right;">1811.61</td><td style="text-align: right;">2</td><td style="text-align: right;">157</td><td style="text-align: right;">0.000154423</td><td style="text-align: right;">43.84</td><td style="text-align: right;">6.61965</td><td style="text-align: right;">0.216315</td><td style="text-align: right;">5703.33</td><td style="text-align: right;">1332.33</td><td style="text-align: right;">-9.39325</td><td style="text-align: right;">0.19654</td><td style="text-align: right;">30.0</td><td style="text-align: right;">23.1925</td><td style="text-align: right;">1.63969</td><td style="text-align: right;">226.8</td><td style="text-align: right;">185.424</td><td style="text-align: right;">2</td><td style="text-align: right;">16</td><td style="text-align: right;">0.000154423</td><td style="text-align: right;">43.84</td><td style="text-align: right;">6.61965</td><td style="text-align: right;">0.00906462</td><td style="text-align: right;">596.48</td><td style="text-align: right;">76.1391</td><td style="text-align: right;">143357</td><td style="text-align: right;">0.0293393</td><td style="text-align: right;">-3.52883</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: right;">14</td><td style="text-align: right;">2012</td><td style="text-align: left;">Audi</td><td style="text-align: left;">Foreign</td><td style="text-align: left;">A1シリーズ</td><td style="text-align: right;">4502</td><td style="text-align: left;">1.4 TFSI</td><td style="text-align: right;">2.835</td><td style="text-align: left;">DBA-8XCAX</td><td style="text-align: right;">19.4</td><td style="text-align: right;">4</td><td style="text-align: left;">ハイオク</td><td style="text-align: right;">54171475</td><td style="text-align: right;">9.94723</td><td style="text-align: right;">0.102521</td><td style="text-align: right;">8.31065e-5</td><td style="text-align: right;">0.919762</td><td style="text-align: right;">0.309984</td><td style="text-align: right;">49.8</td><td style="text-align: right;">33.1791</td><td style="text-align: right;">0.0323769</td><td style="text-align: right;">842.36</td><td style="text-align: right;">370.051</td><td style="text-align: right;">1.83969</td><td style="text-align: right;">298.3</td><td style="text-align: right;">215.509</td><td style="text-align: right;">0.182524</td><td style="text-align: right;">4896.57</td><td style="text-align: right;">2484.02</td><td style="text-align: right;">0.207463</td><td style="text-align: right;">30.4</td><td style="text-align: right;">23.2319</td><td style="text-align: right;">16.1851</td><td style="text-align: right;">2659.3</td><td style="text-align: right;">1891.36</td><td style="text-align: right;">2</td><td style="text-align: right;">164</td><td style="text-align: right;">0.000348865</td><td style="text-align: right;">39.2</td><td style="text-align: right;">6.8118</td><td style="text-align: right;">0.22062</td><td style="text-align: right;">6457.49</td><td style="text-align: right;">1428.51</td><td style="text-align: right;">-9.31175</td><td style="text-align: right;">0.207463</td><td style="text-align: right;">30.4</td><td style="text-align: right;">23.2319</td><td style="text-align: right;">1.5297</td><td style="text-align: right;">248.5</td><td style="text-align: right;">182.33</td><td style="text-align: right;">2</td><td style="text-align: right;">16</td><td style="text-align: right;">0.000348865</td><td style="text-align: right;">39.2</td><td style="text-align: right;">6.8118</td><td style="text-align: right;">0.00466326</td><td style="text-align: right;">434.17</td><td style="text-align: right;">69.7742</td><td style="text-align: right;">159210</td><td style="text-align: right;">0.0282771</td><td style="text-align: right;">-3.5657</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: right;">14</td><td style="text-align: right;">2013</td><td style="text-align: left;">Audi</td><td style="text-align: left;">Foreign</td><td style="text-align: left;">A1シリーズ</td><td style="text-align: right;">5071</td><td style="text-align: left;">1.4 TFSI</td><td style="text-align: right;">2.82326</td><td style="text-align: left;">DBA-8XCAX</td><td style="text-align: right;">19.4</td><td style="text-align: right;">4</td><td style="text-align: left;">ハイオク</td><td style="text-align: right;">54594744</td><td style="text-align: right;">9.94723</td><td style="text-align: right;">0.102521</td><td style="text-align: right;">9.28844e-5</td><td style="text-align: right;">0.919563</td><td style="text-align: right;">0.311828</td><td style="text-align: right;">52.7</td><td style="text-align: right;">33.5456</td><td style="text-align: right;">0.0327145</td><td style="text-align: right;">947.05</td><td style="text-align: right;">378.12</td><td style="text-align: right;">1.95986</td><td style="text-align: right;">334.4</td><td style="text-align: right;">228.399</td><td style="text-align: right;">0.196626</td><td style="text-align: right;">5760.2</td><td style="text-align: right;">2656.1</td><td style="text-align: right;">0.209307</td><td style="text-align: right;">33.3</td><td style="text-align: right;">23.5983</td><td style="text-align: right;">15.5385</td><td style="text-align: right;">2762.2</td><td style="text-align: right;">1857.63</td><td style="text-align: right;">2</td><td style="text-align: right;">161</td><td style="text-align: right;">0.000308215</td><td style="text-align: right;">31.37</td><td style="text-align: right;">7.59138</td><td style="text-align: right;">0.201628</td><td style="text-align: right;">6612.26</td><td style="text-align: right;">1400.56</td><td style="text-align: right;">-9.2003</td><td style="text-align: right;">0.209307</td><td style="text-align: right;">33.3</td><td style="text-align: right;">23.5983</td><td style="text-align: right;">1.64803</td><td style="text-align: right;">281.7</td><td style="text-align: right;">194.853</td><td style="text-align: right;">2</td><td style="text-align: right;">17</td><td style="text-align: right;">0.000308215</td><td style="text-align: right;">31.37</td><td style="text-align: right;">7.59138</td><td style="text-align: right;">0.00467482</td><td style="text-align: right;">281.31</td><td style="text-align: right;">83.5873</td><td style="text-align: right;">191874</td><td style="text-align: right;">0.0264288</td><td style="text-align: right;">-3.6333</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: right;">15</td><td style="text-align: right;">2006</td><td style="text-align: left;">Audi</td><td style="text-align: left;">Foreign</td><td style="text-align: left;">A3シリーズ</td><td style="text-align: right;">4830</td><td style="text-align: left;">アトラクション</td><td style="text-align: right;">2.91889</td><td style="text-align: left;">GH-8PBSE</td><td style="text-align: right;">12.2</td><td style="text-align: right;">5</td><td style="text-align: left;">ハイオク</td><td style="text-align: right;">51102005</td><td style="text-align: right;">10.8151</td><td style="text-align: right;">0.075</td><td style="text-align: right;">9.45168e-5</td><td style="text-align: right;">0.915228</td><td style="text-align: right;">0.163435</td><td style="text-align: right;">23.4</td><td style="text-align: right;">22.4202</td><td style="text-align: right;">0.0134458</td><td style="text-align: right;">274.28</td><td style="text-align: right;">251.645</td><td style="text-align: right;">1.97874</td><td style="text-align: right;">224.8</td><td style="text-align: right;">231.473</td><td style="text-align: right;">0.207998</td><td style="text-align: right;">2577.22</td><td style="text-align: right;">2715.96</td><td style="text-align: right;">0.0884354</td><td style="text-align: right;">11.2</td><td style="text-align: right;">11.6051</td><td style="text-align: right;">16.1609</td><td style="text-align: right;">2391.0</td><td style="text-align: right;">1840.9</td><td style="text-align: right;">1</td><td style="text-align: right;">163</td><td style="text-align: right;">0.000180509</td><td style="text-align: right;">1.0</td><td style="text-align: right;">0.624049</td><td style="text-align: right;">0.255313</td><td style="text-align: right;">4557.36</td><td style="text-align: right;">1004.29</td><td style="text-align: right;">-9.17815</td><td style="text-align: right;">0.0884354</td><td style="text-align: right;">11.2</td><td style="text-align: right;">11.6051</td><td style="text-align: right;">1.81531</td><td style="text-align: right;">201.4</td><td style="text-align: right;">209.053</td><td style="text-align: right;">1</td><td style="text-align: right;">18</td><td style="text-align: right;">0.000180509</td><td style="text-align: right;">1.0</td><td style="text-align: right;">0.624049</td><td style="text-align: right;">0.023506</td><td style="text-align: right;">67.9</td><td style="text-align: right;">47.8497</td><td style="text-align: right;">169488</td><td style="text-align: right;">0.0284976</td><td style="text-align: right;">-3.55794</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: right;">15</td><td style="text-align: right;">2007</td><td style="text-align: left;">Audi</td><td style="text-align: left;">Foreign</td><td style="text-align: left;">A3シリーズ</td><td style="text-align: right;">3874</td><td style="text-align: left;">アトラクション</td><td style="text-align: right;">2.93944</td><td style="text-align: left;">GH-8PBSE</td><td style="text-align: right;">12.2</td><td style="text-align: right;">5</td><td style="text-align: left;">ハイオク</td><td style="text-align: right;">51713048</td><td style="text-align: right;">10.8151</td><td style="text-align: right;">0.075</td><td style="text-align: right;">7.49134e-5</td><td style="text-align: right;">0.920174</td><td style="text-align: right;">0.312689</td><td style="text-align: right;">35.4</td><td style="text-align: right;">33.111</td><td style="text-align: right;">0.0357225</td><td style="text-align: right;">418.28</td><td style="text-align: right;">365.938</td><td style="text-align: right;">2.08997</td><td style="text-align: right;">225.1</td><td style="text-align: right;">232.358</td><td style="text-align: right;">0.230908</td><td style="text-align: right;">2583.73</td><td style="text-align: right;">2733.06</td><td style="text-align: right;">0.237689</td><td style="text-align: right;">23.2</td><td style="text-align: right;">22.2959</td><td style="text-align: right;">16.0534</td><td style="text-align: right;">2382.0</td><td style="text-align: right;">1839.16</td><td style="text-align: right;">2</td><td style="text-align: right;">162</td><td style="text-align: right;">0.00569413</td><td style="text-align: right;">1.04</td><td style="text-align: right;">0.639514</td><td style="text-align: right;">0.252811</td><td style="text-align: right;">4335.92</td><td style="text-align: right;">1039.11</td><td style="text-align: right;">-9.41599</td><td style="text-align: right;">0.237689</td><td style="text-align: right;">23.2</td><td style="text-align: right;">22.2959</td><td style="text-align: right;">1.77728</td><td style="text-align: right;">189.7</td><td style="text-align: right;">199.247</td><td style="text-align: right;">2</td><td style="text-align: right;">17</td><td style="text-align: right;">0.00569413</td><td style="text-align: right;">1.04</td><td style="text-align: right;">0.639514</td><td style="text-align: right;">0.0242194</td><td style="text-align: right;">67.05</td><td style="text-align: right;">45.7941</td><td style="text-align: right;">162015</td><td style="text-align: right;">0.0239114</td><td style="text-align: right;">-3.7334</td></tr></tbody></table></div>
</div>
</div>
<section id="data-cleaning" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">4.1</span> Data cleaning</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data[!, <span class="op">:</span>Foreign_d] <span class="op">=</span> data[<span class="op">:</span>, <span class="op">:</span><span class="dt">Type</span>] <span class="op">.==</span> <span class="st">"Foreign"</span>;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data[!, <span class="op">:</span>FuelRegular_d] <span class="op">=</span> data[<span class="op">:</span>, <span class="op">:</span>FuelType] <span class="op">.==</span> <span class="st">"レギュラー"</span>;</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data[!, <span class="op">:</span>capacity_d] <span class="op">=</span> data[<span class="op">:</span>, <span class="op">:</span>capacity] <span class="op">.&gt;</span> <span class="fl">4</span>;</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">transform!</span>(data, [<span class="op">:</span>year <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="fu">isequal</span>(v))<span class="op">=&gt;</span> <span class="fu">Symbol</span>(<span class="st">"year_"</span> <span class="op">*</span> <span class="fu">string</span>(v)) for v <span class="kw">in</span> <span class="fu">unique</span>(data.year)]);</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">select!</span>(data, <span class="fu">Not</span>(<span class="op">:</span>year_2006));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="section"><span class="header-section-number">4.2</span> 4.2</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort!</span>(data, [<span class="op">:</span>year, <span class="op">:</span>Maker, <span class="op">:</span>price]);</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fu">nrow</span>(data);</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(data.year));</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> <span class="fu">hcat</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">repeat</span>([<span class="fl">1</span>], N), </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Matrix</span>(data[<span class="op">:</span>, [<span class="op">:</span>price, <span class="op">:</span>FuelEfficiency, <span class="op">:</span>hppw, <span class="op">:</span>size, <span class="op">:</span>capacity_d, <span class="op">:</span>FuelRegular_d, <span class="op">:</span>Foreign_d]]),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Matrix</span>(data[<span class="op">:</span>, <span class="st">r"^year_"</span>])    </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> <span class="fu">Matrix</span>(data[<span class="op">:</span>, [<span class="op">:</span>price]]);</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="fu">hcat</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">repeat</span>([<span class="fl">1</span>], N),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Matrix</span>(data[<span class="op">:</span>, [<span class="op">:</span>FuelEfficiency, <span class="op">:</span>hppw, <span class="op">:</span>size, <span class="op">:</span>capacity_d, <span class="op">:</span>FuelRegular_d, <span class="op">:</span>Foreign_d]]),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Matrix</span>(data[<span class="op">:</span>, <span class="st">r"^year_"</span>]),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Matrix</span>(data[<span class="op">:</span>, <span class="st">r"^iv_GH</span><span class="sc">.*</span><span class="ch">(?</span><span class="st">&lt;!nest</span><span class="ch">)</span><span class="sc">$</span><span class="st">"])</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">    );</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>Random<span class="sc">.</span><span class="st">seed!</span><span class="ch">(</span><span class="st">42</span><span class="ch">)</span><span class="st">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>Nsim <span class="op">=</span> <span class="fl">1000</span>;</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>draw_vec <span class="op">=</span> <span class="fu">reduce</span>(hcat, [<span class="fu">randn</span>(<span class="fu">size</span>(X2, <span class="fl">2</span>)) for j <span class="op">=</span><span class="fl">1</span><span class="op">:</span>Nsim]);</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>marketindex <span class="op">=</span> data.year;</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>uniquemarketindex <span class="op">=</span> <span class="fu">sort</span>(<span class="fu">unique</span>(data.year));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>temp1 <span class="op">=</span> <span class="fu">reduce</span>(hcat, [uniquemarketindex for j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>N])<span class="ch">';</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>temp2 <span class="op">=</span> <span class="fu">reduce</span>(hcat, [data.year for j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>T]);</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mkt_denom_d <span class="op">=</span> (temp1 <span class="op">.==</span> temp2);</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">mutable struct</span> datalist_struct</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    X1<span class="op">::</span><span class="dt">Array{Float64,2}</span>;</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    X2<span class="op">::</span><span class="dt">Array{Float64,2}</span>;</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    Z<span class="op">::</span><span class="dt">Array{Float64,2}</span>;</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    ShareVec<span class="op">::</span><span class="dt">Vector{Float64}</span>;</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    marketindex<span class="op">::</span><span class="dt">Vector{Int64}</span>;</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    logitshare<span class="op">::</span><span class="dt">Vector{Float64}</span>;</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    draw_vec<span class="op">::</span><span class="dt">Array{Float64,2}</span>;</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    mkt_denom_d<span class="op">::</span><span class="dt">BitMatrix</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">mutable struct</span> parameter_struct</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    Nsim<span class="op">::</span><span class="dt">Int</span>;</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    T<span class="op">::</span><span class="dt">Int</span>;</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    N<span class="op">::</span><span class="dt">Int</span>;</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>datalist <span class="op">=</span> <span class="fu">datalist_struct</span>(X1, X2, Z, data.share, marketindex, data.logit_share, draw_vec, mkt_denom_d);</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>parameter <span class="op">=</span> <span class="fu">parameter_struct</span>(Nsim, T, N);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-1" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="section-1"><span class="header-section-number">4.3</span> 4.3</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_mktshare</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        theta2,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         delta::Vector{Float64}</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        delta</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> datalist.X2 <span class="op">*</span> <span class="fu">Diagonal</span>(theta2) <span class="op">*</span> datalist.draw_vec;</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    delta_mu <span class="op">=</span> delta <span class="op">.*</span> <span class="fu">ones</span>((<span class="fl">1</span>, parameter.Nsim)) <span class="op">.+</span> mu;</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    exp_delta_mu <span class="op">=</span> <span class="fu">exp</span>.(delta_mu <span class="op">.-</span> <span class="fu">maximum</span>(delta_mu));</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    denom_outside <span class="op">=</span> <span class="fu">exp</span>.(<span class="fu">-maximum</span>(delta_mu));</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    denom_temp <span class="op">=</span> (exp_delta_mu<span class="op">'</span> <span class="op">*</span> datalist.mkt_denom_d)<span class="ch">' .+ denom_outside;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    denom <span class="op">=</span> datalist.mkt_denom_d <span class="op">*</span> denom_temp;</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    s_jt_i <span class="op">=</span> exp_delta_mu <span class="op">./</span> denom;</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    s_jt <span class="op">=</span> <span class="fu">vec</span>(<span class="fu">mean</span>(s_jt_i, dims <span class="op">=</span> <span class="fl">2</span>));</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s_jt</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>f_mktshare (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_contraction</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>        theta2,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        delta_ini<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="fl">1e-11</span>;</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    norm <span class="op">=</span> <span class="fl">1e+10</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    delta_old <span class="op">=</span> delta_ini;</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    exp_delta_old <span class="op">=</span> <span class="fu">exp</span>.(delta_old);</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    iter <span class="op">=</span> <span class="fl">0</span>;</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ((norm <span class="op">&gt;</span> tol) <span class="op">&amp;</span> (iter <span class="op">&lt;</span> <span class="fl">1000</span>))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(iter, "\n")</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        pred_mkt_share <span class="op">=</span> <span class="fu">f_mktshare</span>(theta2, datalist, parameter, delta_old);</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        exp_delta <span class="op">=</span> exp_delta_old <span class="op">.*</span> datalist.ShareVec <span class="op">./</span> pred_mkt_share;</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        norm <span class="op">=</span> <span class="fu">maximum</span>(<span class="fu">abs</span>.(exp_delta <span class="op">.-</span> exp_delta_old));</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        exp_delta_old <span class="op">=</span> exp_delta;</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        delta_old <span class="op">=</span> <span class="fu">log</span>.(exp_delta_old);</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span>;</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(iter, "\n")</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> delta_old;</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>f_contraction (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_GMMobj</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>        theta2,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        delta_ini<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     delta_ini = delta_global;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     delta_ini = datalist.logitshare;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> <span class="fu">f_contraction</span>(theta2, datalist, parameter, delta_ini);</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     global delta_global = delta</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     if (datalist.weight_mat_option == "2SLS") </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        W <span class="op">=</span> <span class="fu">inv</span>(datalist.Z<span class="op">'</span> <span class="op">*</span> datalist.Z);</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     elseif (datalist.weight_mat_option == "Ident")</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#         W = I(size(datalist.Z, 2));</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     end</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    beta_hat <span class="op">=</span> (datalist.X1<span class="op">'</span> <span class="op">*</span> datalist.Z <span class="op">*</span> W <span class="op">*</span> datalist.Z<span class="op">'</span> <span class="op">*</span> datalist.X1) <span class="op">\</span> (datalist.X1<span class="op">'</span> <span class="op">*</span> datalist.Z <span class="op">*</span> W <span class="op">*</span> datalist.Z<span class="op">'</span> <span class="op">*</span> delta);</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    Xi <span class="op">=</span> delta <span class="op">-</span> datalist.X1 <span class="op">*</span> beta_hat;</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> Xi<span class="op">'</span> <span class="op">*</span> datalist.Z <span class="op">*</span> W <span class="op">*</span> datalist.Z<span class="op">'</span> <span class="op">*</span> Xi</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>f_GMMobj (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>initial_x <span class="op">=</span> [<span class="fl">0.1</span>];</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>delta_ini <span class="op">=</span> <span class="fu">f_contraction</span>(initial_x, datalist, parameter, datalist.logitshare);</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>objFunc_for_Optim <span class="op">=</span> <span class="fu">TwiceDifferentiable</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">-&gt;</span> <span class="fu">f_GMMobj</span>(x, parameter, datalist, delta_ini),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    initial_x;</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    autodiff <span class="op">=</span> <span class="op">:</span>forward</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> gmm_res <span class="op">=</span> <span class="fu">optimize</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    objFunc_for_Optim,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     x -&gt; f_GMMobj(x, parameter, datalist, delta_ini),</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.0</span>],</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    [<span class="cn">Inf</span>],</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    initial_x,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    Optim.<span class="fu">Options</span>(show_trace <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> <span class="fu">inv</span>(datalist.Z<span class="op">'</span> <span class="op">*</span> datalist.Z);    </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fu">f_contraction</span>(gmm_res.minimizer, datalist, parameter, delta_ini);</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="op">=</span> (datalist.X1<span class="op">'</span> <span class="op">*</span> datalist.Z <span class="op">*</span> W <span class="op">*</span> datalist.Z<span class="op">'</span> <span class="op">*</span> datalist.X1) <span class="op">\</span> (datalist.X1<span class="op">'</span> <span class="op">*</span> datalist.Z <span class="op">*</span> W <span class="op">*</span> datalist.Z<span class="op">'</span> <span class="op">*</span> delta);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Xi <span class="op">=</span> delta <span class="op">-</span> X1 <span class="op">*</span> beta_hat;</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Omega_hat <span class="op">=</span> <span class="fu">reduce</span>(<span class="op">+</span>, Z[i,<span class="op">:</span>] <span class="op">*</span> Z[i,<span class="op">:</span>]<span class="ch">' .* Xi[i]^2 ./ N for i = 1:N);</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Ddelta <span class="op">=</span> ForwardDiff.<span class="fu">jacobian</span>(x <span class="op">-&gt;</span> delta_ini <span class="op">=</span> <span class="fu">f_contraction</span>(x, datalist, parameter, delta), gmm_res.minimizer);</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> Z<span class="op">'</span> <span class="op">*</span> <span class="fu">hcat</span>(<span class="op">-</span> X1, Ddelta) <span class="op">./</span> N;</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>AsyVarMat <span class="op">=</span> (G<span class="op">'</span> <span class="op">*</span> W <span class="op">*</span> G) <span class="op">\</span> G<span class="op">'</span> <span class="op">*</span> W <span class="op">*</span> Omega_hat <span class="op">*</span> W <span class="op">*</span> G <span class="op">*</span> <span class="fu">inv</span>(G<span class="op">'</span> <span class="op">*</span> W <span class="op">*</span> G);</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Ase <span class="op">=</span> <span class="fu">sqrt</span>.(<span class="fu">diag</span>(AsyVarMat) <span class="op">./</span> N);</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    Var <span class="op">=</span> [</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Const"</span>, <span class="st">"Price"</span>, <span class="st">"Fuel Efficiency"</span>, <span class="st">"hppw"</span>, <span class="st">"size"</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"capacity_d"</span>, <span class="st">"FuelRegular_d"</span>, <span class="st">"Foreign_d"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"year_2007"</span>, <span class="st">"year_2008"</span>, <span class="st">"year_2009"</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"year_2010"</span>, <span class="st">"year_2011"</span>, <span class="st">"year_2012"</span>, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"year_2013"</span>, <span class="st">"year_2014"</span>, <span class="st">"year_2015"</span>, <span class="st">"year_2016"</span>, </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"random_price"</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    Est <span class="op">=</span> <span class="fu">vcat</span>(beta_hat, gmm_res.minimizer),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> Ase</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div><div style="float: left;"><span>19×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Var</th><th style="text-align: left;">Est</th><th style="text-align: left;">se</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String" style="text-align: left;">String</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Const</td><td style="text-align: right;">-13.8731</td><td style="text-align: right;">0.57026</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Price</td><td style="text-align: right;">-2.26772</td><td style="text-align: right;">0.654208</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Fuel Efficiency</td><td style="text-align: right;">0.195358</td><td style="text-align: right;">0.0125426</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">hppw</td><td style="text-align: right;">14.123</td><td style="text-align: right;">3.47038</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">size</td><td style="text-align: right;">0.545374</td><td style="text-align: right;">0.0755396</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: left;">capacity_d</td><td style="text-align: right;">-0.313033</td><td style="text-align: right;">0.137174</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: left;">FuelRegular_d</td><td style="text-align: right;">-1.09267</td><td style="text-align: right;">0.283308</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: left;">Foreign_d</td><td style="text-align: right;">1.02095</td><td style="text-align: right;">0.188846</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: left;">year_2007</td><td style="text-align: right;">-0.832913</td><td style="text-align: right;">0.173999</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: left;">year_2008</td><td style="text-align: right;">-0.701377</td><td style="text-align: right;">0.167621</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: left;">year_2009</td><td style="text-align: right;">-0.85305</td><td style="text-align: right;">0.168625</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: left;">year_2010</td><td style="text-align: right;">-0.0979013</td><td style="text-align: right;">0.15156</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: left;">year_2011</td><td style="text-align: right;">-0.251012</td><td style="text-align: right;">0.150935</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">14</td><td style="text-align: left;">year_2012</td><td style="text-align: right;">-0.482276</td><td style="text-align: right;">0.159593</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">15</td><td style="text-align: left;">year_2013</td><td style="text-align: right;">-0.623362</td><td style="text-align: right;">0.165287</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">16</td><td style="text-align: left;">year_2014</td><td style="text-align: right;">-1.04477</td><td style="text-align: right;">0.180093</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">17</td><td style="text-align: left;">year_2015</td><td style="text-align: right;">-1.1434</td><td style="text-align: right;">0.178264</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">18</td><td style="text-align: left;">year_2016</td><td style="text-align: right;">-1.24577</td><td style="text-align: right;">0.181075</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">19</td><td style="text-align: left;">random_price</td><td style="text-align: right;">0.647326</td><td style="text-align: right;">0.218627</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> X2 <span class="op">*</span> <span class="fu">Diagonal</span>(gmm_res.minimizer) <span class="op">*</span> draw_vec;</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>delta_mu <span class="op">=</span> delta <span class="op">.+</span> mu;</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>exp_delta_mu <span class="op">=</span> <span class="fu">exp</span>.(delta_mu);</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>denom_outside <span class="op">=</span> <span class="fu">exp</span>.(<span class="fl">0.0</span>);</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>denom_temp <span class="op">=</span> (exp_delta_mu<span class="op">'</span> <span class="op">*</span> mkt_denom_d)<span class="ch">' .+ denom_outside;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>denom <span class="op">=</span> mkt_denom_d <span class="op">*</span> denom_temp;</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>s_jt_i <span class="op">=</span> exp_delta_mu <span class="op">./</span> denom;</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>draw_for_price <span class="op">=</span> draw_vec[<span class="fl">1</span>,<span class="op">:</span>];</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>alpha_i <span class="op">=</span> beta_hat[<span class="fl">2</span>] <span class="op">.+</span> gmm_res.minimizer[<span class="fl">1</span>] <span class="op">.*</span> draw_for_price;</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>year <span class="op">=</span> <span class="fl">2016</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>J_t <span class="op">=</span> <span class="fu">sum</span>(data.year <span class="op">.==</span> year);</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>data_t <span class="op">=</span> data[data.year <span class="op">.==</span> year, <span class="op">:</span>];</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>ag_model_s_i <span class="op">=</span> s_jt_i[data.year <span class="op">.==</span> year, <span class="op">:</span>]</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>ag_model_s <span class="op">=</span> <span class="fu">mean</span>(ag_model_s_i, dims <span class="op">=</span> <span class="fl">2</span>);</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>price_t <span class="op">=</span> data.price[data.year <span class="op">.==</span> year];</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>elasmat_t <span class="op">=</span> <span class="fu">zeros</span>((J_t, J_t));</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>J_t, j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>J_t</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (k <span class="op">!=</span> j)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        elasmat_t[k, j] <span class="op">=</span> (<span class="op">-</span><span class="fl">1.0</span>) <span class="op">.*</span> price_t[k] <span class="op">./</span> ag_model_s[j] <span class="op">*</span> <span class="fu">mean</span>(alpha_i <span class="op">.*</span> ag_model_s_i[j, <span class="op">:</span>] <span class="op">.*</span> ag_model_s_i[k, <span class="op">:</span>])</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> (k <span class="op">==</span> j)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        elasmat_t[k, j] <span class="op">=</span> price_t[j] <span class="op">./</span> ag_model_s[j] <span class="op">*</span> <span class="fu">mean</span>(alpha_i <span class="op">.*</span> ag_model_s_i[j, <span class="op">:</span>] <span class="op">.*</span> (<span class="fl">1.0</span> <span class="op">.-</span> ag_model_s_i[j, <span class="op">:</span>]))</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-2" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="section-2"><span class="header-section-number">4.4</span> 5</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Pricevec_t <span class="op">=</span> data_t.price;</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Sharevec_t <span class="op">=</span> data_t.share;</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Ownership_t <span class="op">=</span> data_t.Maker <span class="op">.==</span> <span class="fu">permutedims</span>(data_t.Maker);</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>Derivative_t <span class="op">=</span> <span class="op">-</span> elasmat_t <span class="op">.*</span> Sharevec_t<span class="op">'</span> <span class="op">./</span> Pricevec_t;</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>Delta_t <span class="op">=</span> Derivative_t <span class="op">.*</span> Ownership_t;</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>Marginal_Cost_t <span class="op">=</span> Pricevec_t <span class="op">-</span> (Delta_t <span class="op">\</span> Sharevec_t);</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>pred_mc_df <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    Maker <span class="op">=</span> data_t.Maker, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    Name <span class="op">=</span> data_t.Name, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    Price <span class="op">=</span> data_t.price,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    MC <span class="op">=</span> <span class="fu">Vector</span><span class="dt">{Float64}</span>(Marginal_Cost_t),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    Margin <span class="op">=</span> (data_t.price <span class="op">.-</span> Marginal_Cost_t) <span class="op">./</span> data_t.price</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div><div style="float: left;"><span>169×5 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">144 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Maker</th><th style="text-align: left;">Name</th><th style="text-align: left;">Price</th><th style="text-align: left;">MC</th><th style="text-align: left;">Margin</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String15" style="text-align: left;">String15</th><th title="String31" style="text-align: left;">String31</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Audi</td><td style="text-align: left;">A3シリーズ</td><td style="text-align: right;">3.28</td><td style="text-align: right;">2.37501</td><td style="text-align: right;">0.275912</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Audi</td><td style="text-align: left;">A4シリーズ</td><td style="text-align: right;">5.18</td><td style="text-align: right;">3.63239</td><td style="text-align: right;">0.298766</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">BMW</td><td style="text-align: left;">ミニ</td><td style="text-align: right;">2.4</td><td style="text-align: right;">1.68184</td><td style="text-align: right;">0.299235</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">BMW</td><td style="text-align: left;">1シリーズ</td><td style="text-align: right;">3.1</td><td style="text-align: right;">2.23582</td><td style="text-align: right;">0.278768</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">BMW</td><td style="text-align: left;">X1</td><td style="text-align: right;">3.67</td><td style="text-align: right;">2.65528</td><td style="text-align: right;">0.276489</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: left;">BMW</td><td style="text-align: left;">2シリーズ</td><td style="text-align: right;">3.81</td><td style="text-align: right;">2.75368</td><td style="text-align: right;">0.27725</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: left;">BMW</td><td style="text-align: left;">3シリーズ</td><td style="text-align: right;">4.49</td><td style="text-align: right;">3.2058</td><td style="text-align: right;">0.286013</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: left;">Daihatsu</td><td style="text-align: left;">ミラ</td><td style="text-align: right;">0.885</td><td style="text-align: right;">0.367591</td><td style="text-align: right;">0.584643</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: left;">Daihatsu</td><td style="text-align: left;">ムーヴ</td><td style="text-align: right;">1.134</td><td style="text-align: right;">0.590801</td><td style="text-align: right;">0.479012</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: left;">Daihatsu</td><td style="text-align: left;">ブーン</td><td style="text-align: right;">1.15</td><td style="text-align: right;">0.605056</td><td style="text-align: right;">0.473864</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: left;">Daihatsu</td><td style="text-align: left;">キャスト</td><td style="text-align: right;">1.22</td><td style="text-align: right;">0.667293</td><td style="text-align: right;">0.453039</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: left;">Daihatsu</td><td style="text-align: left;">タント</td><td style="text-align: right;">1.22</td><td style="text-align: right;">0.667293</td><td style="text-align: right;">0.453039</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: left;">Daihatsu</td><td style="text-align: left;">ウェイク</td><td style="text-align: right;">1.35</td><td style="text-align: right;">0.782294</td><td style="text-align: right;">0.420523</td></tr><tr><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">158</td><td style="text-align: left;">Toyota</td><td style="text-align: left;">FJクルーザー</td><td style="text-align: right;">3.24</td><td style="text-align: right;">2.28354</td><td style="text-align: right;">0.295204</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">159</td><td style="text-align: left;">Toyota</td><td style="text-align: left;">エスティマ</td><td style="text-align: right;">3.271</td><td style="text-align: right;">2.30594</td><td style="text-align: right;">0.295034</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">160</td><td style="text-align: left;">Toyota</td><td style="text-align: left;">SAI</td><td style="text-align: right;">3.304</td><td style="text-align: right;">2.32969</td><td style="text-align: right;">0.294888</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">161</td><td style="text-align: left;">Toyota</td><td style="text-align: left;">クラウン</td><td style="text-align: right;">3.812</td><td style="text-align: right;">2.68183</td><td style="text-align: right;">0.296477</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">162</td><td style="text-align: left;">Toyota</td><td style="text-align: left;">ランドクルーザー</td><td style="text-align: right;">4.728</td><td style="text-align: right;">3.25502</td><td style="text-align: right;">0.311544</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">163</td><td style="text-align: left;">Toyota</td><td style="text-align: left;">センチュリー</td><td style="text-align: right;">12.538</td><td style="text-align: right;">7.4994</td><td style="text-align: right;">0.401866</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">164</td><td style="text-align: left;">Volkswagen</td><td style="text-align: left;">ポロ</td><td style="text-align: right;">1.999</td><td style="text-align: right;">1.3488</td><td style="text-align: right;">0.325264</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">165</td><td style="text-align: left;">Volkswagen</td><td style="text-align: left;">ゴルフ</td><td style="text-align: right;">2.499</td><td style="text-align: right;">1.76419</td><td style="text-align: right;">0.294041</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">166</td><td style="text-align: left;">Volkswagen</td><td style="text-align: left;">ビートル</td><td style="text-align: right;">2.699</td><td style="text-align: right;">1.92528</td><td style="text-align: right;">0.28667</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">167</td><td style="text-align: left;">Volkswagen</td><td style="text-align: left;">パサート</td><td style="text-align: right;">3.486</td><td style="text-align: right;">2.52664</td><td style="text-align: right;">0.275203</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">168</td><td style="text-align: left;">Volvo</td><td style="text-align: left;">40シリーズ</td><td style="text-align: right;">3.24</td><td style="text-align: right;">2.3454</td><td style="text-align: right;">0.27611</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">169</td><td style="text-align: left;">Volvo</td><td style="text-align: left;">60シリーズ</td><td style="text-align: right;">4.54</td><td style="text-align: right;">3.24472</td><td style="text-align: right;">0.285305</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(pred_mc_df.Margin, bins <span class="op">=</span> <span class="fl">40</span>, legend <span class="op">=</span> <span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip310">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip310)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip311">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip310)" d="M143.576 1800.78 L2640.76 1800.78 L2640.76 47.2441 L143.576 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip312">
    <rect x="143" y="47" width="2498" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="443.546,1800.78 443.546,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="985.614,1800.78 985.614,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1527.68,1800.78 1527.68,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2069.75,1800.78 2069.75,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2611.82,1800.78 2611.82,47.2441 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="443.546,1800.78 443.546,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="985.614,1800.78 985.614,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1527.68,1800.78 1527.68,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2069.75,1800.78 2069.75,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2611.82,1800.78 2611.82,1781.88 "></polyline>
<path clip-path="url(#clip310)" d="M421.254 1834 Q417.643 1834 415.814 1837.57 Q414.009 1841.11 414.009 1848.24 Q414.009 1855.34 415.814 1858.91 Q417.643 1862.45 421.254 1862.45 Q424.888 1862.45 426.694 1858.91 Q428.522 1855.34 428.522 1848.24 Q428.522 1841.11 426.694 1837.57 Q424.888 1834 421.254 1834 M421.254 1830.3 Q427.064 1830.3 430.12 1834.9 Q433.198 1839.49 433.198 1848.24 Q433.198 1856.96 430.12 1861.57 Q427.064 1866.15 421.254 1866.15 Q415.444 1866.15 412.365 1861.57 Q409.31 1856.96 409.31 1848.24 Q409.31 1839.49 412.365 1834.9 Q415.444 1830.3 421.254 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M441.416 1859.6 L446.3 1859.6 L446.3 1865.48 L441.416 1865.48 L441.416 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M470.652 1846.85 Q474.008 1847.57 475.883 1849.84 Q477.781 1852.1 477.781 1855.44 Q477.781 1860.55 474.263 1863.35 Q470.744 1866.15 464.263 1866.15 Q462.087 1866.15 459.772 1865.71 Q457.481 1865.3 455.027 1864.44 L455.027 1859.93 Q456.971 1861.06 459.286 1861.64 Q461.601 1862.22 464.124 1862.22 Q468.522 1862.22 470.814 1860.48 Q473.129 1858.75 473.129 1855.44 Q473.129 1852.38 470.976 1850.67 Q468.846 1848.93 465.027 1848.93 L460.999 1848.93 L460.999 1845.09 L465.212 1845.09 Q468.661 1845.09 470.49 1843.72 Q472.319 1842.34 472.319 1839.74 Q472.319 1837.08 470.42 1835.67 Q468.545 1834.23 465.027 1834.23 Q463.106 1834.23 460.907 1834.65 Q458.707 1835.07 456.069 1835.95 L456.069 1831.78 Q458.731 1831.04 461.045 1830.67 Q463.383 1830.3 465.444 1830.3 Q470.768 1830.3 473.869 1832.73 Q476.971 1835.14 476.971 1839.26 Q476.971 1842.13 475.328 1844.12 Q473.684 1846.09 470.652 1846.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M962.756 1834 Q959.144 1834 957.316 1837.57 Q955.51 1841.11 955.51 1848.24 Q955.51 1855.34 957.316 1858.91 Q959.144 1862.45 962.756 1862.45 Q966.39 1862.45 968.195 1858.91 Q970.024 1855.34 970.024 1848.24 Q970.024 1841.11 968.195 1837.57 Q966.39 1834 962.756 1834 M962.756 1830.3 Q968.566 1830.3 971.621 1834.9 Q974.7 1839.49 974.7 1848.24 Q974.7 1856.96 971.621 1861.57 Q968.566 1866.15 962.756 1866.15 Q956.945 1866.15 953.867 1861.57 Q950.811 1856.96 950.811 1848.24 Q950.811 1839.49 953.867 1834.9 Q956.945 1830.3 962.756 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M982.917 1859.6 L987.802 1859.6 L987.802 1865.48 L982.917 1865.48 L982.917 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1010.83 1835 L999.028 1853.45 L1010.83 1853.45 L1010.83 1835 M1009.61 1830.92 L1015.49 1830.92 L1015.49 1853.45 L1020.42 1853.45 L1020.42 1857.34 L1015.49 1857.34 L1015.49 1865.48 L1010.83 1865.48 L1010.83 1857.34 L995.232 1857.34 L995.232 1852.82 L1009.61 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1505.56 1834 Q1501.95 1834 1500.13 1837.57 Q1498.32 1841.11 1498.32 1848.24 Q1498.32 1855.34 1500.13 1858.91 Q1501.95 1862.45 1505.56 1862.45 Q1509.2 1862.45 1511 1858.91 Q1512.83 1855.34 1512.83 1848.24 Q1512.83 1841.11 1511 1837.57 Q1509.2 1834 1505.56 1834 M1505.56 1830.3 Q1511.38 1830.3 1514.43 1834.9 Q1517.51 1839.49 1517.51 1848.24 Q1517.51 1856.96 1514.43 1861.57 Q1511.38 1866.15 1505.56 1866.15 Q1499.75 1866.15 1496.68 1861.57 Q1493.62 1856.96 1493.62 1848.24 Q1493.62 1839.49 1496.68 1834.9 Q1499.75 1830.3 1505.56 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1525.73 1859.6 L1530.61 1859.6 L1530.61 1865.48 L1525.73 1865.48 L1525.73 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1540.84 1830.92 L1559.2 1830.92 L1559.2 1834.86 L1545.12 1834.86 L1545.12 1843.33 Q1546.14 1842.98 1547.16 1842.82 Q1548.18 1842.64 1549.2 1842.64 Q1554.99 1842.64 1558.37 1845.81 Q1561.75 1848.98 1561.75 1854.4 Q1561.75 1859.97 1558.27 1863.08 Q1554.8 1866.15 1548.48 1866.15 Q1546.31 1866.15 1544.04 1865.78 Q1541.79 1865.41 1539.38 1864.67 L1539.38 1859.97 Q1541.47 1861.11 1543.69 1861.66 Q1545.91 1862.22 1548.39 1862.22 Q1552.39 1862.22 1554.73 1860.11 Q1557.07 1858.01 1557.07 1854.4 Q1557.07 1850.78 1554.73 1848.68 Q1552.39 1846.57 1548.39 1846.57 Q1546.51 1846.57 1544.64 1846.99 Q1542.79 1847.4 1540.84 1848.28 L1540.84 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2047.05 1834 Q2043.44 1834 2041.62 1837.57 Q2039.81 1841.11 2039.81 1848.24 Q2039.81 1855.34 2041.62 1858.91 Q2043.44 1862.45 2047.05 1862.45 Q2050.69 1862.45 2052.49 1858.91 Q2054.32 1855.34 2054.32 1848.24 Q2054.32 1841.11 2052.49 1837.57 Q2050.69 1834 2047.05 1834 M2047.05 1830.3 Q2052.87 1830.3 2055.92 1834.9 Q2059 1839.49 2059 1848.24 Q2059 1856.96 2055.92 1861.57 Q2052.87 1866.15 2047.05 1866.15 Q2041.24 1866.15 2038.17 1861.57 Q2035.11 1856.96 2035.11 1848.24 Q2035.11 1839.49 2038.17 1834.9 Q2041.24 1830.3 2047.05 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2067.22 1859.6 L2072.1 1859.6 L2072.1 1865.48 L2067.22 1865.48 L2067.22 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2092.86 1846.34 Q2089.72 1846.34 2087.86 1848.49 Q2086.04 1850.65 2086.04 1854.4 Q2086.04 1858.12 2087.86 1860.3 Q2089.72 1862.45 2092.86 1862.45 Q2096.01 1862.45 2097.84 1860.3 Q2099.69 1858.12 2099.69 1854.4 Q2099.69 1850.65 2097.84 1848.49 Q2096.01 1846.34 2092.86 1846.34 M2102.15 1831.69 L2102.15 1835.95 Q2100.39 1835.11 2098.58 1834.67 Q2096.8 1834.23 2095.04 1834.23 Q2090.41 1834.23 2087.96 1837.36 Q2085.53 1840.48 2085.18 1846.8 Q2086.55 1844.79 2088.61 1843.72 Q2090.67 1842.64 2093.14 1842.64 Q2098.35 1842.64 2101.36 1845.81 Q2104.39 1848.96 2104.39 1854.4 Q2104.39 1859.72 2101.24 1862.94 Q2098.1 1866.15 2092.86 1866.15 Q2086.87 1866.15 2083.7 1861.57 Q2080.53 1856.96 2080.53 1848.24 Q2080.53 1840.04 2084.42 1835.18 Q2088.3 1830.3 2094.86 1830.3 Q2096.61 1830.3 2098.4 1830.65 Q2100.2 1830.99 2102.15 1831.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2589.66 1834 Q2586.04 1834 2584.22 1837.57 Q2582.41 1841.11 2582.41 1848.24 Q2582.41 1855.34 2584.22 1858.91 Q2586.04 1862.45 2589.66 1862.45 Q2593.29 1862.45 2595.1 1858.91 Q2596.92 1855.34 2596.92 1848.24 Q2596.92 1841.11 2595.1 1837.57 Q2593.29 1834 2589.66 1834 M2589.66 1830.3 Q2595.47 1830.3 2598.52 1834.9 Q2601.6 1839.49 2601.6 1848.24 Q2601.6 1856.96 2598.52 1861.57 Q2595.47 1866.15 2589.66 1866.15 Q2583.85 1866.15 2580.77 1861.57 Q2577.71 1856.96 2577.71 1848.24 Q2577.71 1839.49 2580.77 1834.9 Q2583.85 1830.3 2589.66 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2609.82 1859.6 L2614.7 1859.6 L2614.7 1865.48 L2609.82 1865.48 L2609.82 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2623.71 1830.92 L2645.93 1830.92 L2645.93 1832.91 L2633.38 1865.48 L2628.5 1865.48 L2640.3 1834.86 L2623.71 1834.86 L2623.71 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="143.576,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="143.576,1419.58 2640.76,1419.58 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="143.576,1038.37 2640.76,1038.37 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="143.576,657.169 2640.76,657.169 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="143.576,275.966 2640.76,275.966 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,1800.78 143.576,47.2441 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,1800.78 162.473,1800.78 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,1419.58 162.473,1419.58 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,1038.37 162.473,1038.37 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,657.169 162.473,657.169 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="143.576,275.966 162.473,275.966 "></polyline>
<path clip-path="url(#clip310)" d="M91.3112 1786.58 Q87.7001 1786.58 85.8714 1790.14 Q84.0658 1793.68 84.0658 1800.81 Q84.0658 1807.92 85.8714 1811.49 Q87.7001 1815.03 91.3112 1815.03 Q94.9454 1815.03 96.7509 1811.49 Q98.5796 1807.92 98.5796 1800.81 Q98.5796 1793.68 96.7509 1790.14 Q94.9454 1786.58 91.3112 1786.58 M91.3112 1782.87 Q97.1213 1782.87 100.177 1787.48 Q103.256 1792.06 103.256 1800.81 Q103.256 1809.54 100.177 1814.15 Q97.1213 1818.73 91.3112 1818.73 Q85.501 1818.73 82.4223 1814.15 Q79.3668 1809.54 79.3668 1800.81 Q79.3668 1792.06 82.4223 1787.48 Q85.501 1782.87 91.3112 1782.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M82.3529 1402.3 L100.709 1402.3 L100.709 1406.23 L86.6353 1406.23 L86.6353 1414.7 Q87.6538 1414.36 88.6723 1414.19 Q89.6908 1414.01 90.7093 1414.01 Q96.4963 1414.01 99.8759 1417.18 Q103.256 1420.35 103.256 1425.77 Q103.256 1431.35 99.7833 1434.45 Q96.3111 1437.53 89.9917 1437.53 Q87.8158 1437.53 85.5473 1437.16 Q83.3019 1436.79 80.8946 1436.05 L80.8946 1431.35 Q82.9779 1432.48 85.2001 1433.04 Q87.4223 1433.59 89.8991 1433.59 Q93.9037 1433.59 96.2417 1431.49 Q98.5796 1429.38 98.5796 1425.77 Q98.5796 1422.16 96.2417 1420.05 Q93.9037 1417.94 89.8991 1417.94 Q88.0241 1417.94 86.1492 1418.36 Q84.2973 1418.78 82.3529 1419.66 L82.3529 1402.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M51.9595 1051.72 L59.5984 1051.72 L59.5984 1025.35 L51.2882 1027.02 L51.2882 1022.76 L59.5521 1021.09 L64.228 1021.09 L64.228 1051.72 L71.8668 1051.72 L71.8668 1055.65 L51.9595 1055.65 L51.9595 1051.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M91.3112 1024.17 Q87.7001 1024.17 85.8714 1027.74 Q84.0658 1031.28 84.0658 1038.41 Q84.0658 1045.51 85.8714 1049.08 Q87.7001 1052.62 91.3112 1052.62 Q94.9454 1052.62 96.7509 1049.08 Q98.5796 1045.51 98.5796 1038.41 Q98.5796 1031.28 96.7509 1027.74 Q94.9454 1024.17 91.3112 1024.17 M91.3112 1020.47 Q97.1213 1020.47 100.177 1025.07 Q103.256 1029.66 103.256 1038.41 Q103.256 1047.13 100.177 1051.74 Q97.1213 1056.32 91.3112 1056.32 Q85.501 1056.32 82.4223 1051.74 Q79.3668 1047.13 79.3668 1038.41 Q79.3668 1029.66 82.4223 1025.07 Q85.501 1020.47 91.3112 1020.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M52.9549 670.514 L60.5937 670.514 L60.5937 644.149 L52.2836 645.815 L52.2836 641.556 L60.5474 639.889 L65.2233 639.889 L65.2233 670.514 L72.8622 670.514 L72.8622 674.449 L52.9549 674.449 L52.9549 670.514 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M82.3529 639.889 L100.709 639.889 L100.709 643.825 L86.6353 643.825 L86.6353 652.297 Q87.6538 651.95 88.6723 651.787 Q89.6908 651.602 90.7093 651.602 Q96.4963 651.602 99.8759 654.774 Q103.256 657.945 103.256 663.361 Q103.256 668.94 99.7833 672.042 Q96.3111 675.121 89.9917 675.121 Q87.8158 675.121 85.5473 674.75 Q83.3019 674.38 80.8946 673.639 L80.8946 668.94 Q82.9779 670.074 85.2001 670.63 Q87.4223 671.186 89.8991 671.186 Q93.9037 671.186 96.2417 669.079 Q98.5796 666.973 98.5796 663.361 Q98.5796 659.75 96.2417 657.644 Q93.9037 655.537 89.8991 655.537 Q88.0241 655.537 86.1492 655.954 Q84.2973 656.371 82.3529 657.25 L82.3529 639.889 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M55.1771 289.311 L71.4965 289.311 L71.4965 293.246 L49.5521 293.246 L49.5521 289.311 Q52.2141 286.556 56.7975 281.927 Q61.4039 277.274 62.5845 275.931 Q64.8298 273.408 65.7094 271.672 Q66.6122 269.913 66.6122 268.223 Q66.6122 265.468 64.6678 263.732 Q62.7465 261.996 59.6447 261.996 Q57.4456 261.996 54.9919 262.76 Q52.5614 263.524 49.7836 265.075 L49.7836 260.353 Q52.6077 259.218 55.0614 258.64 Q57.515 258.061 59.5521 258.061 Q64.9224 258.061 68.1168 260.746 Q71.3113 263.431 71.3113 267.922 Q71.3113 270.052 70.5011 271.973 Q69.7141 273.871 67.6076 276.464 Q67.0289 277.135 63.927 280.353 Q60.8252 283.547 55.1771 289.311 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M91.3112 261.765 Q87.7001 261.765 85.8714 265.33 Q84.0658 268.871 84.0658 276.001 Q84.0658 283.107 85.8714 286.672 Q87.7001 290.214 91.3112 290.214 Q94.9454 290.214 96.7509 286.672 Q98.5796 283.107 98.5796 276.001 Q98.5796 268.871 96.7509 265.33 Q94.9454 261.765 91.3112 261.765 M91.3112 258.061 Q97.1213 258.061 100.177 262.668 Q103.256 267.251 103.256 276.001 Q103.256 284.728 100.177 289.334 Q97.1213 293.917 91.3112 293.917 Q85.501 293.917 82.4223 289.334 Q79.3668 284.728 79.3668 276.001 Q79.3668 267.251 82.4223 262.668 Q85.501 258.061 91.3112 258.061 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip312)" d="M280.925 1114.61 L280.925 1800.78 L335.132 1800.78 L335.132 1114.61 L280.925 1114.61 L280.925 1114.61  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="280.925,1114.61 280.925,1800.78 335.132,1800.78 335.132,1114.61 280.925,1114.61 "></polyline>
<path clip-path="url(#clip312)" d="M335.132 275.966 L335.132 1800.78 L389.339 1800.78 L389.339 275.966 L335.132 275.966 L335.132 275.966  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="335.132,275.966 335.132,1800.78 389.339,1800.78 389.339,275.966 335.132,275.966 "></polyline>
<path clip-path="url(#clip312)" d="M389.339 47.2441 L389.339 1800.78 L443.546 1800.78 L443.546 47.2441 L389.339 47.2441 L389.339 47.2441  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="389.339,47.2441 389.339,1800.78 443.546,1800.78 443.546,47.2441 389.339,47.2441 "></polyline>
<path clip-path="url(#clip312)" d="M443.546 885.891 L443.546 1800.78 L497.752 1800.78 L497.752 885.891 L443.546 885.891 L443.546 885.891  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="443.546,885.891 443.546,1800.78 497.752,1800.78 497.752,885.891 443.546,885.891 "></polyline>
<path clip-path="url(#clip312)" d="M497.752 1190.85 L497.752 1800.78 L551.959 1800.78 L551.959 1190.85 L497.752 1190.85 L497.752 1190.85  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="497.752,1190.85 497.752,1800.78 551.959,1800.78 551.959,1190.85 497.752,1190.85 "></polyline>
<path clip-path="url(#clip312)" d="M551.959 1114.61 L551.959 1800.78 L606.166 1800.78 L606.166 1114.61 L551.959 1114.61 L551.959 1114.61  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="551.959,1114.61 551.959,1800.78 606.166,1800.78 606.166,1114.61 551.959,1114.61 "></polyline>
<path clip-path="url(#clip312)" d="M606.166 1495.82 L606.166 1800.78 L660.373 1800.78 L660.373 1495.82 L606.166 1495.82 L606.166 1495.82  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="606.166,1495.82 606.166,1800.78 660.373,1800.78 660.373,1495.82 606.166,1495.82 "></polyline>
<path clip-path="url(#clip312)" d="M660.373 1114.61 L660.373 1800.78 L714.58 1800.78 L714.58 1114.61 L660.373 1114.61 L660.373 1114.61  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="660.373,1114.61 660.373,1800.78 714.58,1800.78 714.58,1114.61 660.373,1114.61 "></polyline>
<path clip-path="url(#clip312)" d="M714.58 1114.61 L714.58 1800.78 L768.787 1800.78 L768.787 1114.61 L714.58 1114.61 L714.58 1114.61  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="714.58,1114.61 714.58,1800.78 768.787,1800.78 768.787,1114.61 714.58,1114.61 "></polyline>
<path clip-path="url(#clip312)" d="M768.787 1267.09 L768.787 1800.78 L822.994 1800.78 L822.994 1267.09 L768.787 1267.09 L768.787 1267.09  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="768.787,1267.09 768.787,1800.78 822.994,1800.78 822.994,1267.09 768.787,1267.09 "></polyline>
<path clip-path="url(#clip312)" d="M822.994 1572.06 L822.994 1800.78 L877.2 1800.78 L877.2 1572.06 L822.994 1572.06 L822.994 1572.06  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="822.994,1572.06 822.994,1800.78 877.2,1800.78 877.2,1572.06 822.994,1572.06 "></polyline>
<path clip-path="url(#clip312)" d="M877.2 1495.82 L877.2 1800.78 L931.407 1800.78 L931.407 1495.82 L877.2 1495.82 L877.2 1495.82  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="877.2,1495.82 877.2,1800.78 931.407,1800.78 931.407,1495.82 877.2,1495.82 "></polyline>
<path clip-path="url(#clip312)" d="M931.407 1419.58 L931.407 1800.78 L985.614 1800.78 L985.614 1419.58 L931.407 1419.58 L931.407 1419.58  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="931.407,1419.58 931.407,1800.78 985.614,1800.78 985.614,1419.58 931.407,1419.58 "></polyline>
<path clip-path="url(#clip312)" d="M985.614 1038.37 L985.614 1800.78 L1039.82 1800.78 L1039.82 1038.37 L985.614 1038.37 L985.614 1038.37  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="985.614,1038.37 985.614,1800.78 1039.82,1800.78 1039.82,1038.37 985.614,1038.37 "></polyline>
<path clip-path="url(#clip312)" d="M1039.82 1190.85 L1039.82 1800.78 L1094.03 1800.78 L1094.03 1190.85 L1039.82 1190.85 L1039.82 1190.85  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1039.82,1190.85 1039.82,1800.78 1094.03,1800.78 1094.03,1190.85 1039.82,1190.85 "></polyline>
<path clip-path="url(#clip312)" d="M1094.03 1572.06 L1094.03 1800.78 L1148.23 1800.78 L1148.23 1572.06 L1094.03 1572.06 L1094.03 1572.06  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1094.03,1572.06 1094.03,1800.78 1148.23,1800.78 1148.23,1572.06 1094.03,1572.06 "></polyline>
<path clip-path="url(#clip312)" d="M1148.23 1572.06 L1148.23 1800.78 L1202.44 1800.78 L1202.44 1572.06 L1148.23 1572.06 L1148.23 1572.06  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1148.23,1572.06 1148.23,1800.78 1202.44,1800.78 1202.44,1572.06 1148.23,1572.06 "></polyline>
<path clip-path="url(#clip312)" d="M1202.44 1724.54 L1202.44 1800.78 L1256.65 1800.78 L1256.65 1724.54 L1202.44 1724.54 L1202.44 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1202.44,1724.54 1202.44,1800.78 1256.65,1800.78 1256.65,1724.54 1202.44,1724.54 "></polyline>
<path clip-path="url(#clip312)" d="M1256.65 1572.06 L1256.65 1800.78 L1310.86 1800.78 L1310.86 1572.06 L1256.65 1572.06 L1256.65 1572.06  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1256.65,1572.06 1256.65,1800.78 1310.86,1800.78 1310.86,1572.06 1256.65,1572.06 "></polyline>
<path clip-path="url(#clip312)" d="M1310.86 1572.06 L1310.86 1800.78 L1365.06 1800.78 L1365.06 1572.06 L1310.86 1572.06 L1310.86 1572.06  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1310.86,1572.06 1310.86,1800.78 1365.06,1800.78 1365.06,1572.06 1310.86,1572.06 "></polyline>
<path clip-path="url(#clip312)" d="M1365.06 1419.58 L1365.06 1800.78 L1419.27 1800.78 L1419.27 1419.58 L1365.06 1419.58 L1365.06 1419.58  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1365.06,1419.58 1365.06,1800.78 1419.27,1800.78 1419.27,1419.58 1365.06,1419.58 "></polyline>
<path clip-path="url(#clip312)" d="M1419.27 1648.3 L1419.27 1800.78 L1473.48 1800.78 L1473.48 1648.3 L1419.27 1648.3 L1419.27 1648.3  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1419.27,1648.3 1419.27,1800.78 1473.48,1800.78 1473.48,1648.3 1419.27,1648.3 "></polyline>
<path clip-path="url(#clip312)" d="M1473.48 1572.06 L1473.48 1800.78 L1527.68 1800.78 L1527.68 1572.06 L1473.48 1572.06 L1473.48 1572.06  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1473.48,1572.06 1473.48,1800.78 1527.68,1800.78 1527.68,1572.06 1473.48,1572.06 "></polyline>
<path clip-path="url(#clip312)" d="M1527.68 1724.54 L1527.68 1800.78 L1581.89 1800.78 L1581.89 1724.54 L1527.68 1724.54 L1527.68 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1527.68,1724.54 1527.68,1800.78 1581.89,1800.78 1581.89,1724.54 1527.68,1724.54 "></polyline>
<path clip-path="url(#clip312)" d="M1581.89 1800.78 L1581.89 1800.78 L1636.1 1800.78 L1636.1 1800.78 L1581.89 1800.78 L1581.89 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1581.89,1800.78 1581.89,1800.78 1636.1,1800.78 1581.89,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M1636.1 1800.78 L1636.1 1800.78 L1690.3 1800.78 L1690.3 1800.78 L1636.1 1800.78 L1636.1 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1636.1,1800.78 1636.1,1800.78 1690.3,1800.78 1636.1,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M1690.3 1800.78 L1690.3 1800.78 L1744.51 1800.78 L1744.51 1800.78 L1690.3 1800.78 L1690.3 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1690.3,1800.78 1690.3,1800.78 1744.51,1800.78 1690.3,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M1744.51 1800.78 L1744.51 1800.78 L1798.72 1800.78 L1798.72 1800.78 L1744.51 1800.78 L1744.51 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1744.51,1800.78 1744.51,1800.78 1798.72,1800.78 1744.51,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M1798.72 1800.78 L1798.72 1800.78 L1852.92 1800.78 L1852.92 1800.78 L1798.72 1800.78 L1798.72 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1798.72,1800.78 1798.72,1800.78 1852.92,1800.78 1798.72,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M1852.92 1724.54 L1852.92 1800.78 L1907.13 1800.78 L1907.13 1724.54 L1852.92 1724.54 L1852.92 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1852.92,1724.54 1852.92,1800.78 1907.13,1800.78 1907.13,1724.54 1852.92,1724.54 "></polyline>
<path clip-path="url(#clip312)" d="M1907.13 1800.78 L1907.13 1800.78 L1961.34 1800.78 L1961.34 1800.78 L1907.13 1800.78 L1907.13 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1907.13,1800.78 1907.13,1800.78 1961.34,1800.78 1907.13,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M1961.34 1724.54 L1961.34 1800.78 L2015.54 1800.78 L2015.54 1724.54 L1961.34 1724.54 L1961.34 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1961.34,1724.54 1961.34,1800.78 2015.54,1800.78 2015.54,1724.54 1961.34,1724.54 "></polyline>
<path clip-path="url(#clip312)" d="M2015.54 1800.78 L2015.54 1800.78 L2069.75 1800.78 L2069.75 1800.78 L2015.54 1800.78 L2015.54 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2015.54,1800.78 2015.54,1800.78 2069.75,1800.78 2015.54,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M2069.75 1800.78 L2069.75 1800.78 L2123.96 1800.78 L2123.96 1800.78 L2069.75 1800.78 L2069.75 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2069.75,1800.78 2069.75,1800.78 2123.96,1800.78 2069.75,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M2123.96 1800.78 L2123.96 1800.78 L2178.17 1800.78 L2178.17 1800.78 L2123.96 1800.78 L2123.96 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2123.96,1800.78 2123.96,1800.78 2178.17,1800.78 2123.96,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M2178.17 1724.54 L2178.17 1800.78 L2232.37 1800.78 L2232.37 1724.54 L2178.17 1724.54 L2178.17 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2178.17,1724.54 2178.17,1800.78 2232.37,1800.78 2232.37,1724.54 2178.17,1724.54 "></polyline>
<path clip-path="url(#clip312)" d="M2232.37 1800.78 L2232.37 1800.78 L2286.58 1800.78 L2286.58 1800.78 L2232.37 1800.78 L2232.37 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2232.37,1800.78 2232.37,1800.78 2286.58,1800.78 2232.37,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M2286.58 1800.78 L2286.58 1800.78 L2340.79 1800.78 L2340.79 1800.78 L2286.58 1800.78 L2286.58 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2286.58,1800.78 2286.58,1800.78 2340.79,1800.78 2286.58,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M2340.79 1724.54 L2340.79 1800.78 L2394.99 1800.78 L2394.99 1724.54 L2340.79 1724.54 L2340.79 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2340.79,1724.54 2340.79,1800.78 2394.99,1800.78 2394.99,1724.54 2340.79,1724.54 "></polyline>
<path clip-path="url(#clip312)" d="M2394.99 1800.78 L2394.99 1800.78 L2449.2 1800.78 L2449.2 1800.78 L2394.99 1800.78 L2394.99 1800.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2394.99,1800.78 2394.99,1800.78 2449.2,1800.78 2394.99,1800.78 "></polyline>
<path clip-path="url(#clip312)" d="M2449.2 1724.54 L2449.2 1800.78 L2503.41 1800.78 L2503.41 1724.54 L2449.2 1724.54 L2449.2 1724.54  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2449.2,1724.54 2449.2,1800.78 2503.41,1800.78 2503.41,1724.54 2449.2,1724.54 "></polyline>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="308.028" cy="1114.61" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="362.235" cy="275.966" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="416.442" cy="47.2441" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="470.649" cy="885.891" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="524.856" cy="1190.85" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="579.063" cy="1114.61" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="633.27" cy="1495.82" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="687.476" cy="1114.61" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="741.683" cy="1114.61" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="795.89" cy="1267.09" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="850.097" cy="1572.06" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="904.304" cy="1495.82" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="958.511" cy="1419.58" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1012.72" cy="1038.37" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1066.92" cy="1190.85" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1121.13" cy="1572.06" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1175.34" cy="1572.06" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1229.55" cy="1724.54" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1283.75" cy="1572.06" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1337.96" cy="1572.06" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1392.17" cy="1419.58" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1446.37" cy="1648.3" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1500.58" cy="1572.06" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1554.79" cy="1724.54" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1608.99" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1663.2" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1717.41" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1771.61" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1825.82" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1880.03" cy="1724.54" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1934.23" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1988.44" cy="1724.54" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2042.65" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2096.86" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2151.06" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2205.27" cy="1724.54" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2259.48" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2313.68" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2367.89" cy="1724.54" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2422.1" cy="1800.78" r="2"></circle>
<circle clip-path="url(#clip312)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2476.3" cy="1724.54" r="2"></circle>
</svg>
</div>
</div>
</section>
<section id="section-3" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="section-3"><span class="header-section-number">4.5</span> 6</h2>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_2016 <span class="op">=</span> data[data.year <span class="op">.==</span> <span class="fl">2016</span>, <span class="op">:</span>];</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data_2016 <span class="op">=</span> <span class="fu">leftjoin</span>(data_2016, pred_mc_df, on <span class="op">=</span> [<span class="st">"Maker"</span>, <span class="st">"Name"</span>]);</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dropmissing!</span>(data_2016);</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>data_2016[data_2016.Maker <span class="op">.==</span> <span class="st">"Honda"</span>, <span class="op">:</span>Maker] <span class="op">.=</span> <span class="st">"Nippyo"</span>;</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>data_2016[data_2016.Maker <span class="op">.==</span> <span class="st">"Nissan"</span>, <span class="op">:</span>Maker] <span class="op">.=</span> <span class="st">"BrandA"</span>;</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>data_2016[data_2016.Maker <span class="op">.==</span> <span class="st">"Subaru"</span>, <span class="op">:</span>Maker] <span class="op">.=</span> <span class="st">"BrandB"</span>;</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>data_2016[data_2016.Maker <span class="op">.==</span> <span class="st">"Toyota"</span>, <span class="op">:</span>Maker] <span class="op">.=</span> <span class="st">"BrandC"</span>;</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>data_2016[!, <span class="op">:</span>MakerNippyoA] <span class="op">=</span> data_2016[<span class="op">:</span>, <span class="op">:</span>Maker];</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>data_2016[!, <span class="op">:</span>MakerNippyoB] <span class="op">=</span> data_2016[<span class="op">:</span>, <span class="op">:</span>Maker];</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>data_2016[<span class="fu">in</span>([<span class="st">"Nippyo"</span>, <span class="st">"BrandA"</span>]).(data_2016[<span class="op">:</span>, <span class="op">:</span>Maker]), <span class="op">:</span>MakerNippyoA] <span class="op">.=</span> <span class="st">"NippyoA"</span>;</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>data_2016[<span class="fu">in</span>([<span class="st">"Nippyo"</span>, <span class="st">"BrandB"</span>]).(data_2016[<span class="op">:</span>, <span class="op">:</span>Maker]), <span class="op">:</span>MakerNippyoB] <span class="op">.=</span> <span class="st">"NippyoB"</span>;</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>J <span class="op">=</span> <span class="fu">nrow</span>(data_2016);</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>Ownership_true <span class="op">=</span> data_2016.Maker <span class="op">.==</span> <span class="fu">permutedims</span>(data_2016.Maker);</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>Ownership_NippyoA <span class="op">=</span> data_2016.MakerNippyoA <span class="op">.==</span> <span class="fu">permutedims</span>(data_2016.MakerNippyoA);</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>Ownership_NippyoB <span class="op">=</span> data_2016.MakerNippyoB <span class="op">.==</span> <span class="fu">permutedims</span>(data_2016.MakerNippyoB);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-4" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="section-4"><span class="header-section-number">4.6</span> 6.4</h2>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> data_2016.MC;</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>datalist_2016 <span class="op">=</span> <span class="fu">datalist_struct</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    X1[data.year <span class="op">.==</span> <span class="fl">2016</span>, <span class="op">:</span>],</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    X2[data.year <span class="op">.==</span> <span class="fl">2016</span>, <span class="op">:</span>],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    Z[data.year <span class="op">.==</span> <span class="fl">2016</span>, <span class="op">:</span>],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    data_2016.share,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    data_2016.year,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    data_2016.logit_share,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    datalist.draw_vec,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    datalist.mkt_denom_d[data.year <span class="op">.==</span> <span class="fl">2016</span>, <span class="op">:</span>]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_update</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        p_old<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        Ownership<span class="op">::</span><span class="dt">BitMatrix</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        theta1<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        theta2<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        mc<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        Xi<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    X1_new <span class="op">=</span> datalist.X1[<span class="op">:</span>, <span class="op">:</span>];</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    X2_new <span class="op">=</span> <span class="fu">reshape</span>(p_old, (<span class="op">:</span>, <span class="fl">1</span>));</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    X1_new[<span class="op">:</span>, <span class="fl">2</span>] <span class="op">.=</span> p_old;</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> (X1_new <span class="op">*</span> theta1) <span class="op">.+</span> Xi;</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    datalist_new <span class="op">=</span> <span class="fu">datalist_struct</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        X1_new, X2_new, datalist.Z, datalist.ShareVec, datalist.marketindex, </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        datalist.logitshare, datalist.draw_vec, datalist.mkt_denom_d</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        );</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    Sharevec <span class="op">=</span> <span class="fu">f_mktshare</span>(</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        theta2, datalist_new, parameter, delta</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># elasticity</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> datalist_new.X2 <span class="op">*</span> <span class="fu">Diagonal</span>(theta2) <span class="op">*</span> datalist_new.draw_vec;</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    delta_mu <span class="op">=</span> delta <span class="op">.+</span> mu;</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    exp_delta_mu <span class="op">=</span> <span class="fu">exp</span>.(delta_mu);</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    denom_outside <span class="op">=</span> <span class="fu">exp</span>.(<span class="fl">0.0</span>);</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    denom_temp <span class="op">=</span> (exp_delta_mu<span class="op">'</span> <span class="op">*</span> datalist_new.mkt_denom_d)<span class="ch">' .+ denom_outside;</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    denom <span class="op">=</span> datalist_new.mkt_denom_d <span class="op">*</span> denom_temp;</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    s_jt_i <span class="op">=</span> exp_delta_mu <span class="op">./</span> denom;</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    draw_for_price <span class="op">=</span> datalist_new.draw_vec[<span class="fl">1</span>,<span class="op">:</span>];</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    alpha_i <span class="op">=</span> theta1[<span class="fl">2</span>] <span class="op">.+</span> theta2[<span class="fl">1</span>] <span class="op">.*</span> draw_for_price;</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    J <span class="op">=</span> <span class="fu">size</span>(X1_new, <span class="fl">1</span>);</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    ag_model_s <span class="op">=</span> <span class="fu">mean</span>(s_jt_i, dims <span class="op">=</span> <span class="fl">2</span>);</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    elasmat <span class="op">=</span> <span class="fu">zeros</span>((J, J));</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>J, j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>J</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (k <span class="op">!=</span> j)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>            elasmat[k, j] <span class="op">=</span> (<span class="op">-</span><span class="fl">1.0</span>) <span class="op">.*</span> p_old[k] <span class="op">./</span> ag_model_s[j] <span class="op">*</span> <span class="fu">mean</span>(alpha_i <span class="op">.*</span> s_jt_i[j, <span class="op">:</span>] <span class="op">.*</span> s_jt_i[k, <span class="op">:</span>])</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elseif</span> (k <span class="op">==</span> j)</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>            elasmat[k, j] <span class="op">=</span> p_old[j] <span class="op">./</span> ag_model_s[j] <span class="op">*</span> <span class="fu">mean</span>(alpha_i <span class="op">.*</span> s_jt_i[j, <span class="op">:</span>] <span class="op">.*</span> (<span class="fl">1.0</span> <span class="op">.-</span> s_jt_i[j, <span class="op">:</span>]))</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>    Derivative <span class="op">=</span> <span class="op">-</span> elasmat <span class="op">.*</span> Sharevec<span class="op">'</span> <span class="op">./</span> p_old;</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    Delta <span class="op">=</span> Derivative <span class="op">.*</span> Ownership;</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    p_new <span class="op">=</span> mc <span class="op">.+</span> (Delta <span class="op">\</span> Sharevec)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p_new</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>f_update (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_eqprice</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        p_ini<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        Ownership<span class="op">::</span><span class="dt">BitMatrix</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        theta1<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        theta2<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        mc<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        Xi<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    lambda <span class="op">=</span> <span class="fl">1e-6</span>;</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    p_old <span class="op">=</span> p_ini;</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    distance <span class="op">=</span> <span class="fl">10000</span>;</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> p_new</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (distance <span class="op">&gt;</span> lambda)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        p_new <span class="op">=</span> <span class="fu">f_update</span>(datalist, p_old, Ownership, parameter, theta1, theta2, mc, Xi);</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        distance <span class="op">=</span> <span class="fu">maximum</span>(<span class="fu">abs</span>.(p_new <span class="op">-</span> p_old));</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        p_old <span class="op">=</span> p_new[<span class="op">:</span>];</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(distance, "\n")</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p_new</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>f_eqprice (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="section-5" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="section-5"><span class="header-section-number">4.7</span> 6.5</h2>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p_ini <span class="op">=</span> data_2016.price;</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>p_NippyoA <span class="op">=</span> <span class="fu">f_eqprice</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    datalist_2016,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    p_ini,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    Ownership_NippyoA,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    parameter,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    beta_hat,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    mc,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>p_ini <span class="op">=</span> data_2016.price;</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>p_NippyoB <span class="op">=</span> <span class="fu">f_eqprice</span>(</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    datalist_2016,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    p_ini,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    Ownership_NippyoB,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    parameter,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    beta_hat,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    mc,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_mktshare_sim</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        p<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        theta1<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        theta2<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        Xi<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    X1_new <span class="op">=</span> datalist.X1[<span class="op">:</span>, <span class="op">:</span>];</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    X2_new <span class="op">=</span> <span class="fu">reshape</span>(p[<span class="op">:</span>], (<span class="op">:</span>, <span class="fl">1</span>));</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    X1_new[<span class="op">:</span>, <span class="fl">2</span>] <span class="op">.=</span> p;</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> (X1_new <span class="op">*</span> theta1) <span class="op">.+</span> Xi;</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    datalist_new <span class="op">=</span> <span class="fu">datalist_struct</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        X1_new, X2_new, datalist.Z, datalist.ShareVec, datalist.marketindex, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        datalist.logitshare, datalist.draw_vec, datalist.mkt_denom_d</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        );</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    Sharevec <span class="op">=</span> <span class="fu">f_mktshare</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        theta2, datalist_new, parameter, delta</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(Sharevec)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>f_mktshare_sim (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="section-6" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="section-6"><span class="header-section-number">4.8</span> 7</h2>
</section>
<section id="section-7" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="section-7"><span class="header-section-number">4.9</span> 7.1</h2>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>merger_sim_df <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    Maker <span class="op">=</span> data_2016.Maker, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    Name <span class="op">=</span> data_2016.Name, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    Price_A <span class="op">=</span> (p_NippyoA <span class="op">.-</span> data_2016.price) <span class="op">./</span> data_2016.price <span class="op">.*</span> <span class="fl">100.0</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    Share_A <span class="op">=</span> (<span class="fu">f_mktshare_sim</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                datalist_2016,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                p_NippyoA,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                parameter,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                beta_hat,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                gmm_res.minimizer,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">.-</span> data_2016.share) <span class="op">./</span> data_2016.share <span class="op">.*</span> <span class="fl">100.0</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    Price_B <span class="op">=</span> (p_NippyoB <span class="op">.-</span> data_2016.price) <span class="op">./</span> data_2016.price <span class="op">.*</span> <span class="fl">100.0</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    Share_B <span class="op">=</span> (<span class="fu">f_mktshare_sim</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                datalist_2016,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                p_NippyoB,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                parameter,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                beta_hat,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                gmm_res.minimizer,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">.-</span> data_2016.share) <span class="op">./</span> data_2016.share <span class="op">.*</span> <span class="fl">100.0</span>,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>merger_sim_df[<span class="fu">in</span>([<span class="st">"Nippyo"</span>, <span class="st">"BrandA"</span>, <span class="st">"BrandB"</span>, <span class="st">"BrandC"</span>]).(merger_sim_df.Maker), <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div><div style="float: left;"><span>92×6 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">67 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Maker</th><th style="text-align: left;">Name</th><th style="text-align: left;">Price_A</th><th style="text-align: left;">Share_A</th><th style="text-align: left;">Price_B</th><th style="text-align: left;">Share_B</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String15" style="text-align: left;">String15</th><th title="String31" style="text-align: left;">String31</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">N-WGN</td><td style="text-align: right;">0.528904</td><td style="text-align: right;">-1.08573</td><td style="text-align: right;">0.200634</td><td style="text-align: right;">-0.412253</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">N-ONE</td><td style="text-align: right;">0.525627</td><td style="text-align: right;">-1.09385</td><td style="text-align: right;">0.199727</td><td style="text-align: right;">-0.416064</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">N-BOX</td><td style="text-align: right;">0.514136</td><td style="text-align: right;">-1.12708</td><td style="text-align: right;">0.196685</td><td style="text-align: right;">-0.431724</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">フィット</td><td style="text-align: right;">0.510693</td><td style="text-align: right;">-1.13894</td><td style="text-align: right;">0.19583</td><td style="text-align: right;">-0.43734</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">バモス</td><td style="text-align: right;">0.503396</td><td style="text-align: right;">-1.16852</td><td style="text-align: right;">0.194146</td><td style="text-align: right;">-0.451391</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">シャトル</td><td style="text-align: right;">0.486998</td><td style="text-align: right;">-1.3015</td><td style="text-align: right;">0.192368</td><td style="text-align: right;">-0.515434</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">グレイス</td><td style="text-align: right;">0.486127</td><td style="text-align: right;">-1.32499</td><td style="text-align: right;">0.192777</td><td style="text-align: right;">-0.526882</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">フリード</td><td style="text-align: right;">0.485831</td><td style="text-align: right;">-1.38128</td><td style="text-align: right;">0.194403</td><td style="text-align: right;">-0.55445</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">ヴェゼル</td><td style="text-align: right;">0.486195</td><td style="text-align: right;">-1.3988</td><td style="text-align: right;">0.195076</td><td style="text-align: right;">-0.563071</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">S660</td><td style="text-align: right;">0.48711</td><td style="text-align: right;">-1.42526</td><td style="text-align: right;">0.196225</td><td style="text-align: right;">-0.576117</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">ステップワゴン</td><td style="text-align: right;">0.497936</td><td style="text-align: right;">-1.56393</td><td style="text-align: right;">0.204493</td><td style="text-align: right;">-0.645058</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">CR-V</td><td style="text-align: right;">0.5085</td><td style="text-align: right;">-1.64777</td><td style="text-align: right;">0.211013</td><td style="text-align: right;">-0.687093</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">ジェイド</td><td style="text-align: right;">0.51258</td><td style="text-align: right;">-1.67565</td><td style="text-align: right;">0.213399</td><td style="text-align: right;">-0.701116</td></tr><tr><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">81</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">エスクァイア</td><td style="text-align: right;">0.00505423</td><td style="text-align: right;">0.0455417</td><td style="text-align: right;">0.00243967</td><td style="text-align: right;">0.0185788</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">82</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ハイエースワゴン</td><td style="text-align: right;">0.00505213</td><td style="text-align: right;">0.0459376</td><td style="text-align: right;">0.0024417</td><td style="text-align: right;">0.0187698</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">83</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ハリアー</td><td style="text-align: right;">0.0050453</td><td style="text-align: right;">0.0466928</td><td style="text-align: right;">0.00244393</td><td style="text-align: right;">0.0191362</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">84</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">アルファード</td><td style="text-align: right;">0.00495413</td><td style="text-align: right;">0.0499348</td><td style="text-align: right;">0.00241818</td><td style="text-align: right;">0.0207371</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">85</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ヴェルファイア</td><td style="text-align: right;">0.00495413</td><td style="text-align: right;">0.0499348</td><td style="text-align: right;">0.00241818</td><td style="text-align: right;">0.0207371</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">86</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">カムリ</td><td style="text-align: right;">0.00495022</td><td style="text-align: right;">0.0500152</td><td style="text-align: right;">0.0024166</td><td style="text-align: right;">0.0207774</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">87</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">FJクルーザー</td><td style="text-align: right;">0.00493705</td><td style="text-align: right;">0.0502725</td><td style="text-align: right;">0.00241121</td><td style="text-align: right;">0.0209066</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">88</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">エスティマ</td><td style="text-align: right;">0.00492334</td><td style="text-align: right;">0.0505216</td><td style="text-align: right;">0.00240544</td><td style="text-align: right;">0.021032</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">89</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">SAI</td><td style="text-align: right;">0.0049077</td><td style="text-align: right;">0.0507866</td><td style="text-align: right;">0.00239871</td><td style="text-align: right;">0.0211657</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">90</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">クラウン</td><td style="text-align: right;">0.00450612</td><td style="text-align: right;">0.0548772</td><td style="text-align: right;">0.00220451</td><td style="text-align: right;">0.0232696</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">91</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ランドクルーザー</td><td style="text-align: right;">0.00284137</td><td style="text-align: right;">0.0624546</td><td style="text-align: right;">0.00132154</td><td style="text-align: right;">0.027341</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">92</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">センチュリー</td><td style="text-align: right;">-0.00246452</td><td style="text-align: right;">0.0523554</td><td style="text-align: right;">-0.00159183</td><td style="text-align: right;">0.0219765</td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="section-8" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="section-8"><span class="header-section-number">4.10</span> 7.2</h2>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Pricevec <span class="op">=</span> data_2016.price;</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Sharevec <span class="op">=</span> data_2016.share;</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>Ownership <span class="op">=</span> data_2016.MakerNippyoA <span class="op">.==</span> <span class="fu">permutedims</span>(data_2016.MakerNippyoA);</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>Derivative <span class="op">=</span> <span class="op">-</span> elasmat_t <span class="op">.*</span> Sharevec<span class="op">'</span> <span class="op">./</span> Pricevec;</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>Delta <span class="op">=</span> Derivative <span class="op">.*</span> Ownership;</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>mc_NippyoA_pfix <span class="op">=</span> Pricevec <span class="op">-</span> (Delta <span class="op">\</span> Sharevec);</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>Ownership <span class="op">=</span> data_2016.MakerNippyoB <span class="op">.==</span> <span class="fu">permutedims</span>(data_2016.MakerNippyoB);</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>Derivative <span class="op">=</span> <span class="op">-</span> elasmat_t <span class="op">.*</span> Sharevec<span class="op">'</span> <span class="op">./</span> Pricevec;</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>Delta <span class="op">=</span> Derivative <span class="op">.*</span> Ownership;</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>mc_NippyoB_pfix <span class="op">=</span> Pricevec <span class="op">-</span> (Delta <span class="op">\</span> Sharevec);</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>mc_sim_df <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    Maker <span class="op">=</span> data_2016.Maker, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    Name <span class="op">=</span> data_2016.Name, </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    Nippyo_and_Brand_A <span class="op">=</span> (mc_NippyoA_pfix <span class="op">.-</span> mc) <span class="op">./</span> mc <span class="op">.*</span> <span class="fl">100.0</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    Nippyo_and_Brand_B <span class="op">=</span> (mc_NippyoB_pfix <span class="op">.-</span> mc) <span class="op">./</span> mc <span class="op">.*</span> <span class="fl">100.0</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>mc_sim_df[<span class="fu">in</span>([<span class="st">"Nippyo"</span>, <span class="st">"BrandA"</span>, <span class="st">"BrandB"</span>, <span class="st">"BrandC"</span>]).(mc_sim_df.Maker), <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div><div style="float: left;"><span>92×4 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">67 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Maker</th><th style="text-align: left;">Name</th><th style="text-align: left;">Nippyo_and_Brand_A</th><th style="text-align: left;">Nippyo_and_Brand_B</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String15" style="text-align: left;">String15</th><th title="String31" style="text-align: left;">String31</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">N-WGN</td><td style="text-align: right;">-0.913246</td><td style="text-align: right;">-0.347271</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">N-ONE</td><td style="text-align: right;">-0.895623</td><td style="text-align: right;">-0.341138</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">N-BOX</td><td style="text-align: right;">-0.83478</td><td style="text-align: right;">-0.320098</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">フィット</td><td style="text-align: right;">-0.816657</td><td style="text-align: right;">-0.313882</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">バモス</td><td style="text-align: right;">-0.777854</td><td style="text-align: right;">-0.300681</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">シャトル</td><td style="text-align: right;">-0.672993</td><td style="text-align: right;">-0.266414</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">グレイス</td><td style="text-align: right;">-0.661754</td><td style="text-align: right;">-0.262989</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">フリード</td><td style="text-align: right;">-0.640238</td><td style="text-align: right;">-0.256743</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">ヴェゼル</td><td style="text-align: right;">-0.63483</td><td style="text-align: right;">-0.255265</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">S660</td><td style="text-align: right;">-0.627628</td><td style="text-align: right;">-0.253382</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">ステップワゴン</td><td style="text-align: right;">-0.604134</td><td style="text-align: right;">-0.248681</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">CR-V</td><td style="text-align: right;">-0.598054</td><td style="text-align: right;">-0.248784</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: left;">Nippyo</td><td style="text-align: left;">ジェイド</td><td style="text-align: right;">-0.596997</td><td style="text-align: right;">-0.249167</td></tr><tr><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">81</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">エスクァイア</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">82</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ハイエースワゴン</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">83</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ハリアー</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">84</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">アルファード</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">85</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ヴェルファイア</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">86</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">カムリ</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">87</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">FJクルーザー</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">88</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">エスティマ</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">89</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">SAI</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">90</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">クラウン</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">91</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">ランドクルーザー</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">92</td><td style="text-align: left;">BrandC</td><td style="text-align: left;">センチュリー</td><td style="text-align: right;">0.0</td><td style="text-align: right;">0.0</td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="section-9" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="section-9"><span class="header-section-number">4.11</span> 7.4</h2>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>alpha_i <span class="op">=</span> <span class="op">-</span> (beta_hat[<span class="fl">2</span>] <span class="op">.+</span> gmm_res.minimizer[<span class="fl">1</span>] <span class="op">*</span> draw_for_price)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data_2016.HH[<span class="fl">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>56950757</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_CS</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        p<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        theta1<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        theta2<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        Xi<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        HH<span class="op">::</span><span class="dt">Int64</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    X1_new <span class="op">=</span> datalist.X1[<span class="op">:</span>, <span class="op">:</span>];</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    X2_new <span class="op">=</span> <span class="fu">reshape</span>(p, (<span class="op">:</span>, <span class="fl">1</span>));</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    X1_new[<span class="op">:</span>, <span class="fl">2</span>] <span class="op">.=</span> p;</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> (X1_new <span class="op">*</span> theta1) <span class="op">.+</span> Xi;</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># elasticity</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> X2_new <span class="op">*</span> <span class="fu">Diagonal</span>(theta2) <span class="op">*</span> datalist.draw_vec;</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> delta <span class="op">.+</span> mu;</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    exp_V <span class="op">=</span> <span class="fu">exp</span>.(V);</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    numerator <span class="op">=</span> <span class="fu">log</span>.(<span class="fu">vec</span>(<span class="fu">sum</span>(exp_V, dims <span class="op">=</span> <span class="fl">1</span>)) <span class="op">.+</span> <span class="fl">1.0</span>);</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    draw_for_price <span class="op">=</span> datalist.draw_vec[<span class="fl">1</span>,<span class="op">:</span>];</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    alpha_i <span class="op">=</span> <span class="op">-</span> (theta1[<span class="fl">2</span>] <span class="op">.+</span> theta2[<span class="fl">1</span>] <span class="op">.*</span> draw_for_price);</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    CS <span class="op">=</span> <span class="fu">mean</span>(numerator <span class="op">./</span> alpha_i) <span class="op">.*</span> HH;</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> CS</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>CS_2016 <span class="op">=</span> <span class="fu">f_CS</span>(</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    data_2016.price, </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>], </span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    data_2016.HH[<span class="fl">1</span>]</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>CS_NippyoA <span class="op">=</span> <span class="fu">f_CS</span>(</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    p_NippyoA, </span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>], </span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    data_2016.HH[<span class="fl">1</span>]</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>CS_NippyoB <span class="op">=</span> <span class="fu">f_CS</span>(</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>    p_NippyoB, </span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>], </span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    data_2016.HH[<span class="fl">1</span>]</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>CV_NippyoA <span class="op">=</span> CS_NippyoA <span class="op">-</span> CS_2016;</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>CV_NippyoB <span class="op">=</span> CS_NippyoB <span class="op">-</span> CS_2016;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>f_profit <span class="op">=</span> <span class="kw">function</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>        Maker<span class="op">::</span><span class="dt">AbstractVector</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        price<span class="op">::</span><span class="dt">Vector{Float64}</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        mc<span class="op">::</span><span class="dt">Vector{Float64}</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        share<span class="op">::</span><span class="dt">Vector{Float64}</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        HH<span class="op">::</span><span class="dt">Vector{Int64}</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        Maker <span class="op">=</span> Maker,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        price <span class="op">=</span> price,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        mc <span class="op">=</span> mc,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        share <span class="op">=</span> share,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        HH <span class="op">=</span> HH,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        profit <span class="op">=</span> (price <span class="op">-</span> mc) <span class="op">.*</span> share <span class="op">.*</span> HH,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        revenue <span class="op">=</span> price<span class="op">.*</span> share <span class="op">.*</span> HH</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(<span class="fu">combine</span>(<span class="fu">groupby</span>(dt, <span class="op">:</span>Maker), [<span class="op">:</span>profit, <span class="op">:</span>revenue] <span class="op">.=&gt;</span> sum <span class="op">.=&gt;</span> [<span class="op">:</span>profit, <span class="op">:</span>revenue]))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>#27 (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pro_rev_2016 <span class="op">=</span> <span class="fu">f_profit</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    data_2016.Maker,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    data_2016.price,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    mc,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    data_2016.share,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    data_2016.HH</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>pro_rev_NippyoA <span class="op">=</span> <span class="fu">f_profit</span>(</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    data_2016.Maker,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    p_NippyoA,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    mc,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">f_mktshare_sim</span>(</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                datalist_2016,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                p_NippyoA,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                parameter,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                beta_hat,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                gmm_res.minimizer,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    data_2016.HH</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>pro_rev_NippyoB <span class="op">=</span> <span class="fu">f_profit</span>(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    data_2016.Maker,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    p_NippyoB,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    mc,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">f_mktshare_sim</span>(</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                datalist_2016,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>                p_NippyoB,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                parameter,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>                beta_hat,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                gmm_res.minimizer,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>                Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    data_2016.HH</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>TS_change_NippyoA <span class="op">=</span> CV_NippyoA <span class="op">+</span> <span class="fu">sum</span>(pro_rev_NippyoA.profit <span class="op">-</span> pro_rev_2016.profit);</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>TS_change_NippyoB <span class="op">=</span> CV_NippyoB <span class="op">+</span> <span class="fu">sum</span>(pro_rev_NippyoB.profit <span class="op">-</span> pro_rev_2016.profit);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    Measure <span class="op">=</span> [<span class="st">"Consumer surplus"</span>, <span class="st">"Total welfare"</span>],</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    Nippyo_and_Brand_A <span class="op">=</span> [CV_NippyoA, TS_change_NippyoA],</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    Nippyo_and_Brand_B <span class="op">=</span> [CV_NippyoB, TS_change_NippyoB],</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Measure</th><th style="text-align: left;">Nippyo_and_Brand_A</th><th style="text-align: left;">Nippyo_and_Brand_B</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String" style="text-align: left;">String</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Consumer surplus</td><td style="text-align: right;">-11486.1</td><td style="text-align: right;">-4617.72</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Total welfare</td><td style="text-align: right;">-10275.0</td><td style="text-align: right;">-4082.23</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>result_df <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    Maker <span class="op">=</span> pro_rev_2016.Maker,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    Profits_NippyoA <span class="op">=</span> pro_rev_NippyoA.profit <span class="op">-</span> pro_rev_2016.profit,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    Revenue_NippyoA <span class="op">=</span> pro_rev_NippyoA.revenue <span class="op">-</span> pro_rev_2016.revenue,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    Profits_NippyoB <span class="op">=</span> pro_rev_NippyoB.profit <span class="op">-</span> pro_rev_2016.profit,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    Revenue_NippyoB <span class="op">=</span> pro_rev_NippyoB.revenue <span class="op">-</span> pro_rev_2016.revenue,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>total_df <span class="op">=</span> <span class="fu">combine</span>(result_df, <span class="fl">2</span><span class="op">:</span><span class="fl">5</span> <span class="op">.=&gt;</span> sum <span class="op">.=&gt;</span> <span class="fu">names</span>(result_df)[<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>]);</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>total_df[!, <span class="op">:</span>Maker] <span class="op">.=</span> <span class="st">"Total"</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">append!</span>(result_df, total_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div><div style="float: left;"><span>16×5 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Maker</th><th style="text-align: left;">Profits_NippyoA</th><th style="text-align: left;">Revenue_NippyoA</th><th style="text-align: left;">Profits_NippyoB</th><th style="text-align: left;">Revenue_NippyoB</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String15" style="text-align: left;">String15</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Audi</td><td style="text-align: right;">11.42</td><td style="text-align: right;">39.3669</td><td style="text-align: right;">5.00774</td><td style="text-align: right;">17.2094</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">BMW</td><td style="text-align: right;">37.8657</td><td style="text-align: right;">123.311</td><td style="text-align: right;">16.4744</td><td style="text-align: right;">52.9189</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Daihatsu</td><td style="text-align: right;">108.936</td><td style="text-align: right;">208.968</td><td style="text-align: right;">44.2344</td><td style="text-align: right;">83.5685</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">Fiat</td><td style="text-align: right;">1.52418</td><td style="text-align: right;">4.14223</td><td style="text-align: right;">0.639666</td><td style="text-align: right;">1.70164</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">Lexas</td><td style="text-align: right;">59.8269</td><td style="text-align: right;">199.098</td><td style="text-align: right;">25.9303</td><td style="text-align: right;">87.8</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: left;">Matsuda</td><td style="text-align: right;">59.4818</td><td style="text-align: right;">151.83</td><td style="text-align: right;">24.8492</td><td style="text-align: right;">62.3322</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: left;">Mercedes</td><td style="text-align: right;">52.2646</td><td style="text-align: right;">174.885</td><td style="text-align: right;">22.6072</td><td style="text-align: right;">77.1302</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: left;">Mitsubishi</td><td style="text-align: right;">20.5141</td><td style="text-align: right;">50.3782</td><td style="text-align: right;">8.53346</td><td style="text-align: right;">20.6598</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: left;">Suzuki</td><td style="text-align: right;">114.119</td><td style="text-align: right;">216.394</td><td style="text-align: right;">46.3145</td><td style="text-align: right;">86.5724</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: left;">Volkswagen</td><td style="text-align: right;">19.5327</td><td style="text-align: right;">58.8824</td><td style="text-align: right;">8.34637</td><td style="text-align: right;">24.6511</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: left;">Volvo</td><td style="text-align: right;">9.3833</td><td style="text-align: right;">32.0072</td><td style="text-align: right;">4.1136</td><td style="text-align: right;">13.8844</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: left;">Nippyo</td><td style="text-align: right;">78.9811</td><td style="text-align: right;">-9184.5</td><td style="text-align: right;">42.7737</td><td style="text-align: right;">-3672.28</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: left;">BrandA</td><td style="text-align: right;">14.0327</td><td style="text-align: right;">-10407.1</td><td style="text-align: right;">57.2739</td><td style="text-align: right;">142.533</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">14</td><td style="text-align: left;">BrandB</td><td style="text-align: right;">55.1002</td><td style="text-align: right;">153.123</td><td style="text-align: right;">-12.0312</td><td style="text-align: right;">-4885.14</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">15</td><td style="text-align: left;">BrandC</td><td style="text-align: right;">568.091</td><td style="text-align: right;">1412.74</td><td style="text-align: right;">240.429</td><td style="text-align: right;">584.277</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">16</td><td style="text-align: left;">Total</td><td style="text-align: right;">1211.07</td><td style="text-align: right;">-16766.5</td><td style="text-align: right;">535.496</td><td style="text-align: right;">-7302.18</td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="section-10" class="level2" data-number="4.12">
<h2 data-number="4.12" class="anchored" data-anchor-id="section-10"><span class="header-section-number">4.12</span> 8</h2>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_effect_cost_reduction</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>        cost_red<span class="op">::</span><span class="dt">Float64</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>        cost_red_firm<span class="op">::</span><span class="dt">AbstractVector</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        Ownership<span class="op">::</span><span class="dt">BitMatrix</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        data<span class="op">::</span><span class="dt">DataFrame</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        mc<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        datalist<span class="op">::</span><span class="dt">datalist_struct</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        parameter<span class="op">::</span><span class="dt">parameter_struct</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        theta1<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        theta2<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        HH<span class="op">::</span><span class="dt">Vector{Int64}</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        p_pre<span class="op">::</span><span class="dt">Vector{Float64}</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        pro_rev_pre<span class="op">::</span><span class="dt">DataFrame</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        CS_pre<span class="op">::</span><span class="dt">Float64</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        Xi<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    mc_new <span class="op">=</span> mc[<span class="op">:</span>];</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    mc_new[<span class="fu">in</span>(cost_red_firm).(data.Maker)] <span class="op">=</span> mc_new[<span class="fu">in</span>(cost_red_firm).(data.Maker)] <span class="op">.*</span> cost_red;</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    p_post <span class="op">=</span> <span class="fu">f_eqprice</span>(datalist, p_pre, Ownership, parameter, theta1, theta2, mc_new, Xi);</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    CV <span class="op">=</span> <span class="fu">f_CS</span>(datalist, p_post, parameter, theta1, theta2, Xi, HH[<span class="fl">1</span>]) <span class="op">-</span> CS_pre;</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    share_post <span class="op">=</span> <span class="fu">f_mktshare_sim</span>(datalist, p_post, parameter, theta1, theta2, Xi);</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    pro_rev_post <span class="op">=</span> <span class="fu">f_profit</span>(data.Maker, p_post, mc, share_post, HH);</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    TS_change <span class="op">=</span> CV <span class="op">+</span> <span class="fu">sum</span>(pro_rev_post.profit <span class="op">.-</span> pro_rev_pre.profit);</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> TS_change</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>f_effect_cost_reduction (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="section-11" class="level2" data-number="4.13">
<h2 data-number="4.13" class="anchored" data-anchor-id="section-11"><span class="header-section-number">4.13</span> 8.2</h2>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cost_red_firm <span class="op">=</span> [<span class="st">"Nippyo"</span>, <span class="st">"Brand_A"</span>];</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>distance <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="op">=</span> <span class="fl">1e-6</span>;</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>max_cost_red <span class="op">=</span> <span class="fl">1.0</span>;</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>min_cost_red <span class="op">=</span> <span class="fl">0.0</span>;</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>iter <span class="op">=</span> <span class="fl">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> <span class="cf">while</span> (distance <span class="op">&gt;</span> lambda) <span class="op">&amp;</span> (iter <span class="op">&lt;</span> <span class="fl">100</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    mid_cost_red <span class="op">=</span> (max_cost_red <span class="op">+</span> min_cost_red) <span class="op">/</span> <span class="fl">2.0</span>;</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    mid_eval <span class="op">=</span> <span class="fu">f_effect_cost_reduction</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        mid_cost_red,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        cost_red_firm,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        Ownership_NippyoA,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        data_2016,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        mc,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        datalist_2016,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        parameter,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        beta_hat,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        gmm_res.minimizer,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        data_2016.HH,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        p_NippyoA,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        pro_rev_2016,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        CS_2016,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> mid_eval <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        min_cost_red <span class="op">=</span> mid_cost_red;</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>        max_cost_red <span class="op">=</span> mid_cost_red;</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    distance <span class="op">=</span> <span class="fu">abs</span>(mid_eval <span class="op">-</span> <span class="fl">0</span>);</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(distance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(min_cost_red, ",", max_cost_red, ",", mid_cost_red, "\n")</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>cost_red_NippyoA <span class="op">=</span> (min_cost_red <span class="op">+</span> min_cost_red) <span class="op">/</span> <span class="fl">2.0</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>0.9856680991833855</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mc_NippyoA_TSfix <span class="op">=</span> mc[<span class="op">:</span>];</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mc_NippyoA_TSfix[<span class="fu">in</span>(cost_red_firm).(data_2016.Maker)] <span class="op">=</span> (</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    mc_NippyoA_TSfix[<span class="fu">in</span>(cost_red_firm).(data_2016.Maker)] <span class="op">.*</span> cost_red_NippyoA</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p_NippyoA_TSfix <span class="op">=</span> <span class="fu">f_eqprice</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    p_NippyoA, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    Ownership_NippyoA, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    mc_NippyoA_TSfix, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>share_NippyoA_TSfix <span class="op">=</span> <span class="fu">f_mktshare_sim</span>(</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    p_NippyoA_TSfix, </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-12" class="level2" data-number="4.14">
<h2 data-number="4.14" class="anchored" data-anchor-id="section-12"><span class="header-section-number">4.14</span> 8.3</h2>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cost_red_firm <span class="op">=</span> [<span class="st">"Nippyo"</span>, <span class="st">"Brand_B"</span>];</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>distance <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="op">=</span> <span class="fl">1e-6</span>;</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>max_cost_red <span class="op">=</span> <span class="fl">1.0</span>;</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>min_cost_red <span class="op">=</span> <span class="fl">0.0</span>;</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>iter <span class="op">=</span> <span class="fl">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> <span class="cf">while</span> (distance <span class="op">&gt;</span> lambda) <span class="op">&amp;</span> (iter <span class="op">&lt;</span> <span class="fl">100</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    mid_cost_red <span class="op">=</span> (max_cost_red <span class="op">+</span> min_cost_red) <span class="op">/</span> <span class="fl">2.0</span>;</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    mid_eval <span class="op">=</span> <span class="fu">f_effect_cost_reduction</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        mid_cost_red,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>        cost_red_firm,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        Ownership_NippyoB,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        data_2016,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        mc,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        datalist_2016,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        parameter,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        beta_hat,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>        gmm_res.minimizer,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>        data_2016.HH,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>        p_NippyoB,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        pro_rev_2016,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        CS_2016,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> mid_eval <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>        min_cost_red <span class="op">=</span> mid_cost_red;</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>        max_cost_red <span class="op">=</span> mid_cost_red;</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    distance <span class="op">=</span> <span class="fu">abs</span>(mid_eval <span class="op">-</span> <span class="fl">0</span>);</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(distance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(min_cost_red, ",", max_cost_red, ",", mid_cost_red, "\n")</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>    iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>cost_red_NippyoB <span class="op">=</span> (min_cost_red <span class="op">+</span> min_cost_red) <span class="op">/</span> <span class="fl">2.0</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>0.9943264803296188</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mc_NippyoB_TSfix <span class="op">=</span> mc[<span class="op">:</span>];</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>mc_NippyoB_TSfix[<span class="fu">in</span>(cost_red_firm).(data_2016.Maker)] <span class="op">=</span> (</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    mc_NippyoB_TSfix[<span class="fu">in</span>(cost_red_firm).(data_2016.Maker)] <span class="op">.*</span> cost_red_NippyoB</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>p_NippyoB_TSfix <span class="op">=</span> <span class="fu">f_eqprice</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    p_NippyoB, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    Ownership_NippyoB,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    mc_NippyoB_TSfix, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>share_NippyoB_TSfix <span class="op">=</span> <span class="fu">f_mktshare_sim</span>(</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    datalist_2016, </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    p_NippyoB_TSfix, </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    parameter, </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    beta_hat, </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    gmm_res.minimizer, </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    Xi[data.year <span class="op">.==</span> <span class="fl">2016</span>]</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span> <span class="op">-</span> cost_red_NippyoA <span class="fl">1</span> <span class="op">-</span> cost_red_NippyoB] <span class="op">.*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>1×2 Matrix{Float64}:
 1.43319  0.567352</code></pre>
</div>
</div>
</section>
<section id="section-13" class="level2" data-number="4.15">
<h2 data-number="4.15" class="anchored" data-anchor-id="section-13"><span class="header-section-number">4.15</span> 8.5</h2>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pro_rev_NippyoA_rc <span class="op">=</span> <span class="fu">f_profit</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    data_2016.Maker,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    p_NippyoA_TSfix,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    mc_NippyoA_TSfix,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    share_NippyoA_TSfix,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    data_2016.HH</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>pro_rev_NippyoB_rc <span class="op">=</span> <span class="fu">f_profit</span>(</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    data_2016.Maker,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    p_NippyoB_TSfix,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    mc_NippyoB_TSfix,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    share_NippyoB_TSfix,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    data_2016.HH</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>result2_df <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    Maker <span class="op">=</span> pro_rev_2016.Maker,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    Profits_NippyoA <span class="op">=</span> pro_rev_NippyoA_rc.profit <span class="op">-</span> pro_rev_2016.profit,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    Revenue_NippyoA <span class="op">=</span> pro_rev_NippyoA_rc.revenue <span class="op">-</span> pro_rev_2016.revenue,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    Profits_NippyoB <span class="op">=</span> pro_rev_NippyoB_rc.profit <span class="op">-</span> pro_rev_2016.profit,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    Revenue_NippyoB <span class="op">=</span> pro_rev_NippyoB_rc.revenue <span class="op">-</span> pro_rev_2016.revenue,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>total2_df <span class="op">=</span> <span class="fu">combine</span>(result2_df, <span class="fl">2</span><span class="op">:</span><span class="fl">5</span> <span class="op">.=&gt;</span> sum <span class="op">.=&gt;</span> <span class="fu">names</span>(result2_df)[<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>]);</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>total2_df[!, <span class="op">:</span>Maker] <span class="op">.=</span> <span class="st">"Total"</span>;</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="fu">append!</span>(result2_df, total2_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div><div style="float: left;"><span>16×5 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Maker</th><th style="text-align: left;">Profits_NippyoA</th><th style="text-align: left;">Revenue_NippyoA</th><th style="text-align: left;">Profits_NippyoB</th><th style="text-align: left;">Revenue_NippyoB</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String15" style="text-align: left;">String15</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Audi</td><td style="text-align: right;">0.578278</td><td style="text-align: right;">0.637611</td><td style="text-align: right;">0.709338</td><td style="text-align: right;">1.85086</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">BMW</td><td style="text-align: right;">1.16365</td><td style="text-align: right;">0.743377</td><td style="text-align: right;">1.92048</td><td style="text-align: right;">4.30378</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Daihatsu</td><td style="text-align: right;">-1.23683</td><td style="text-align: right;">-3.20943</td><td style="text-align: right;">0.510195</td><td style="text-align: right;">-0.652691</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">Fiat</td><td style="text-align: right;">-0.000300335</td><td style="text-align: right;">-0.0395873</td><td style="text-align: right;">0.034865</td><td style="text-align: right;">0.0422145</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">Lexas</td><td style="text-align: right;">5.24057</td><td style="text-align: right;">7.2343</td><td style="text-align: right;">4.29229</td><td style="text-align: right;">11.7282</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: left;">Matsuda</td><td style="text-align: right;">-0.0455557</td><td style="text-align: right;">-1.40967</td><td style="text-align: right;">1.23194</td><td style="text-align: right;">1.52314</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: left;">Mercedes</td><td style="text-align: right;">4.44846</td><td style="text-align: right;">6.19975</td><td style="text-align: right;">3.65229</td><td style="text-align: right;">10.2477</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: left;">Mitsubishi</td><td style="text-align: right;">-0.0396423</td><td style="text-align: right;">-0.471821</td><td style="text-align: right;">0.378446</td><td style="text-align: right;">0.481087</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: left;">Suzuki</td><td style="text-align: right;">-1.3003</td><td style="text-align: right;">-3.30166</td><td style="text-align: right;">0.50768</td><td style="text-align: right;">-0.632405</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: left;">Volkswagen</td><td style="text-align: right;">0.208558</td><td style="text-align: right;">-0.216559</td><td style="text-align: right;">0.681591</td><td style="text-align: right;">1.20412</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: left;">Volvo</td><td style="text-align: right;">0.380303</td><td style="text-align: right;">0.354901</td><td style="text-align: right;">0.543972</td><td style="text-align: right;">1.33128</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: left;">Nippyo</td><td style="text-align: right;">9976.91</td><td style="text-align: right;">10995.0</td><td style="text-align: right;">3925.25</td><td style="text-align: right;">4286.01</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: left;">BrandA</td><td style="text-align: right;">-125.931</td><td style="text-align: right;">-10955.2</td><td style="text-align: right;">3.06225</td><td style="text-align: right;">4.28647</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">14</td><td style="text-align: left;">BrandB</td><td style="text-align: right;">0.323965</td><td style="text-align: right;">-0.879382</td><td style="text-align: right;">-34.1722</td><td style="text-align: right;">-4980.65</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">15</td><td style="text-align: left;">BrandC</td><td style="text-align: right;">4.27964</td><td style="text-align: right;">-11.8808</td><td style="text-align: right;">16.7721</td><td style="text-align: right;">18.9825</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">16</td><td style="text-align: left;">Total</td><td style="text-align: right;">9864.98</td><td style="text-align: right;">33.5695</td><td style="text-align: right;">3925.37</td><td style="text-align: right;">-639.946</td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="section-14" class="level2" data-number="4.16">
<h2 data-number="4.16" class="anchored" data-anchor-id="section-14"><span class="header-section-number">4.16</span> 8.6</h2>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Change in profit by Brand A merger (%): "</span>, (<span class="fu">sum</span>(pro_rev_NippyoA_rc.profit) <span class="op">.-</span> <span class="fu">sum</span>(pro_rev_2016.profit)) <span class="op">./</span> <span class="fu">sum</span>(pro_rev_2016.profit) <span class="op">.*</span> <span class="fl">100.0</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Change in revenue by Brand A merger (%): "</span>, (<span class="fu">sum</span>(pro_rev_NippyoA_rc.revenue) <span class="op">.-</span> <span class="fu">sum</span>(pro_rev_2016.revenue)) <span class="op">./</span> <span class="fu">sum</span>(pro_rev_2016.revenue) <span class="op">.*</span> <span class="fl">100.0</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Change in profit by Brand B merger (%): "</span>, (<span class="fu">sum</span>(pro_rev_NippyoB_rc.profit) <span class="op">.-</span> <span class="fu">sum</span>(pro_rev_2016.profit)) <span class="op">./</span> <span class="fu">sum</span>(pro_rev_2016.profit) <span class="op">.*</span> <span class="fl">100.0</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Change in revenue by Brand B merger (%): "</span>, (<span class="fu">sum</span>(pro_rev_NippyoB_rc.revenue) <span class="op">.-</span> <span class="fu">sum</span>(pro_rev_2016.revenue)) <span class="op">./</span> <span class="fu">sum</span>(pro_rev_2016.revenue) <span class="op">.*</span> <span class="fl">100.0</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Change in profit by Brand A merger (%): 0.36380146936382757
Change in revenue by Brand A merger (%): 0.00044982645552334383
Change in profit by Brand B merger (%): 0.14476020559469857
Change in revenue by Brand B merger (%): -0.008575171067045903</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./demand_estimation_2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">需要モデルの推定（基礎編 2）</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./entry_exit_basic.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">参入ゲームの推定（基礎編）</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>